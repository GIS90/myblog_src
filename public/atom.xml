<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>PyGo²</title>
  
  <subtitle>一个爱&lt;font size=&quot;5&quot; color=&quot;#BF0060&quot;&gt;老婆&lt;/font&gt;的&lt;font size=&quot;5&quot; color=&quot;#FF4500&quot;&gt;Python&lt;/font&gt;程序猿。。。。。。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://pygo2.cn/"/>
  <updated>2020-07-07T13:00:04.000Z</updated>
  <id>http://pygo2.cn/</id>
  
  <author>
    <name>mingliang.gao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mysql常用命令</title>
    <link href="http://pygo2.cn/articles/14802/"/>
    <id>http://pygo2.cn/articles/14802/</id>
    <published>2020-07-07T13:00:04.000Z</published>
    <updated>2020-07-07T13:00:04.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p><img src="/images/article_mysql.png" alt></p><div class="note primary">            <p>记录一下常用的命令，虽然关于查询相关的命令常用（select、order by、where、join等），但是关于建立数据库、建立用户、授权等并不常用的命令，做个整理，也方便了自己进行查询和使用</p>          </div><a id="more"></a><hr><h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>表复制分为表结构复制、表数据复制与整表（表结构+表数据）复制。</p><blockquote><p>创建数据库</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database 数据库名称 default character set utf8 collate utf8_general_ci;</span><br></pre></td></tr></table></figure><blockquote><p>创建用户</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create user &apos;用户名&apos;@&apos;%&apos; IDENTIFIED BY &apos;密码&apos;;</span><br><span class="line">-- % 表示通配符，任意远程主机都可以连接主机</span><br><span class="line"></span><br><span class="line">create user &apos;用户名&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;123456&apos;;</span><br><span class="line">-- localhost 表示本机，用户只有通过本机进行连接主机</span><br><span class="line"></span><br><span class="line">create user &apos;用户名&apos;@&apos;XXX.XXX.XX.XXX&apos; IDENTIFIED BY &apos;123456&apos;;</span><br><span class="line">-- XXX.XXX.XX.XXX 表示ip，用户只有通过指定的ip主机进行连接</span><br></pre></td></tr></table></figure><blockquote><p>授权</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 所有权限 所有表</span><br><span class="line">grant all on *.* to &apos;用户名称&apos;;</span><br><span class="line"></span><br><span class="line"># 所有权限 指定数据库</span><br><span class="line">grant * on 数据库名称.* to &apos;用户名称&apos;;</span><br><span class="line"></span><br><span class="line"># 指定权限 指定数据库</span><br><span class="line">grant select,insert,update,delete,create on 数据库名称.* to &apos;用户名称&apos;;</span><br><span class="line"></span><br><span class="line">flush  privileges;</span><br><span class="line"></span><br><span class="line"># 查看权限</span><br><span class="line">show grants for &apos;用户名称&apos;;</span><br></pre></td></tr></table></figure><blockquote><p>其他</p></blockquote><p>数据库列表：show database;<br>表列表：show tables;</p><div class="post_cus_note">查询方面略</div>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/article_mysql.png&quot; alt&gt;&lt;/p&gt;
&lt;div class=&quot;note primary&quot;&gt;
            &lt;p&gt;记录一下常用的命令，虽然关于查询相关的命令常用（select、order by、where、join等），但是关于建立数据库、建立用户、授权等并不常用的命令，做个整理，也方便了自己进行查询和使用&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://pygo2.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="Mysql" scheme="http://pygo2.cn/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>Qita-抖音BMG</title>
    <link href="http://pygo2.cn/articles/16635/"/>
    <id>http://pygo2.cn/articles/16635/</id>
    <published>2020-06-30T05:47:57.000Z</published>
    <updated>2020-06-30T05:47:57.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p><img src="/images/article_douyin.jpg" alt></p><div class="note primary">            <p>抖音记录美好生活</p><p>记录自己喜欢的BGM，喜欢的请拿去，不用谢</p>          </div><a id="more"></a><hr><ul><li>batte fort 凤舞九天：<a href="https://music.163.com/#/song?id=1379910808&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/#/song?id=1379910808&amp;userid=555314631</a></li><li>Dan Bălan-Lendo Calendo：<a href="https://music.163.com/#/song?id=1435770027&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/#/song?id=1435770027&amp;userid=555314631</a></li><li>等什么君-赤伶：<a href="https://music.163.com/song?id=1447509197&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=1447509197&amp;userid=555314631</a></li><li>杨千嬅-野孩子抖音：<a href="https://music.163.com/song?id=1385757429&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=1385757429&amp;userid=555314631</a></li><li>猜不透 (咚鼓版)：<a href="https://music.163.com/song?id=1361558668&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=1361558668&amp;userid=555314631</a></li><li>真的爱你 (咚鼓版)：<a href="https://music.163.com/song?id=1396568322&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=1396568322&amp;userid=555314631</a></li><li>送给未来的你(DJ弹鼓版)：<a href="https://music.163.com/song?id=1425463866&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=1425463866&amp;userid=555314631</a></li><li>Tony Igy-Astronomia：<a href="https://music.163.com/song?id=446154202&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=446154202&amp;userid=555314631</a></li><li>世间美好与你环环相扣：<a href="https://music.163.com/song?id=1399664349&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=1399664349&amp;userid=555314631</a></li><li>Be Your Sun (DJ版)：<a href="https://music.163.com/song?id=1386946637&amp;userid=555314631" target="_blank" rel="noopener">https://music.163.com/song?id=1386946637&amp;userid=555314631</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/article_douyin.jpg&quot; alt&gt;&lt;/p&gt;
&lt;div class=&quot;note primary&quot;&gt;
            &lt;p&gt;抖音记录美好生活&lt;/p&gt;&lt;p&gt;记录自己喜欢的BGM，喜欢的请拿去，不用谢&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Python-信息管理系统</title>
    <link href="http://pygo2.cn/articles/12268/"/>
    <id>http://pygo2.cn/articles/12268/</id>
    <published>2020-06-25T05:09:00.000Z</published>
    <updated>2020-06-25T05:09:00.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="Python" scheme="http://pygo2.cn/categories/Python/"/>
    
    
      <category term="Python" scheme="http://pygo2.cn/tags/Python/"/>
    
      <category term="Python程序篇" scheme="http://pygo2.cn/tags/Python%E7%A8%8B%E5%BA%8F%E7%AF%87/"/>
    
  </entry>
  
  <entry>
    <title>Linux学习之番外篇-nohup</title>
    <link href="http://pygo2.cn/articles/23692/"/>
    <id>http://pygo2.cn/articles/23692/</id>
    <published>2020-05-13T01:46:47.000Z</published>
    <updated>2020-05-13T01:46:47.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>WIKI Confluence授权的延期</title>
    <link href="http://pygo2.cn/articles/39160/"/>
    <id>http://pygo2.cn/articles/39160/</id>
    <published>2020-04-16T01:14:11.000Z</published>
    <updated>2020-04-16T01:14:11.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h4><div class="post_cus_note">关于WIKI Confluence的延期授权</div><a id="more"></a><hr><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><blockquote><p>点击My Altassian，进入到<a href="https://my.atlassian.com/官网。" target="_blank" rel="noopener">https://my.atlassian.com/官网。</a></p></blockquote><p><img src="1.png" alt></p><blockquote><p>点击New Trial License，创建新的Trial License。</p></blockquote><p><img src="2.png" alt></p><blockquote><p>选择相关对应的产品：confluence。</p></blockquote><p><img src="3.png" alt></p><blockquote><p>使用admin登录confluence服务器。</p></blockquote><p><img src="4.png" alt></p><blockquote><p>查看confluence的服务器ID，在<font color="red" size="6.0">设置-&gt;一般配置-&gt;管理→授权细节</font>，复制服务ID信息。</p></blockquote><p><img src="5.png" alt></p><blockquote><p>在填写New Trial License页面的相关信息，选择confluence产品，输入服务器ID，在create license，会自动生成授权码（复制）。</p></blockquote><p><img src="6.png" alt></p><blockquote><p>回到confluence授权细节页面，把复制的授权码粘贴在授权细节中的授权码，点击保存，完成延期使用。</p></blockquote><p><img src="7.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;简述&quot;&gt;&lt;a href=&quot;#简述&quot; class=&quot;headerlink&quot; title=&quot;简述&quot;&gt;&lt;/a&gt;简述&lt;/h4&gt;
&lt;div class=&quot;post_cus_note&quot;&gt;关于WIKI Confluence的延期授权&lt;/div&gt;
    
    </summary>
    
      <category term="工具集" scheme="http://pygo2.cn/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    
    
      <category term="WIKI" scheme="http://pygo2.cn/tags/WIKI/"/>
    
      <category term="运维工具" scheme="http://pygo2.cn/tags/%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>Mysql的表复制</title>
    <link href="http://pygo2.cn/articles/34145/"/>
    <id>http://pygo2.cn/articles/34145/</id>
    <published>2020-04-15T06:12:43.000Z</published>
    <updated>2020-04-15T06:12:43.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p><img src="/images/article_mariadb.jpeg" alt></p><div class="note primary">            <p>玩数据的都会涉及数据库，虽然Navicate带来了许多便利，但是本人还是喜欢使用sql，本篇介绍一下关于表复制的相关sql。</p>          </div><a id="more"></a><hr><h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>表复制分为表结构复制、表数据复制与整表（表结构+表数据）复制。</p><blockquote><p>表结构</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 创建表结构</span><br><span class="line">CREATE TABLE 新表 LIKE 旧表;</span><br><span class="line"></span><br><span class="line">CREATE TABLE 新表 SELECT * FROM 旧表 WHERE 1=2;</span><br><span class="line"></span><br><span class="line">SELECT * INTO 表2 FROM 表1 WHERE 1=2;</span><br><span class="line"></span><br><span class="line"># 查看创建表的sql</span><br><span class="line">SHOW CREATE TABLE 旧表;</span><br></pre></td></tr></table></figure><blockquote><p>表数据</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * INTO 新表 FROM 旧表;</span><br><span class="line"></span><br><span class="line">INSERT INTO 新表 SELECT * FROM 旧表;</span><br></pre></td></tr></table></figure><blockquote><p>表结构+表数据</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 新表 SELECT * FROM 旧表;</span><br></pre></td></tr></table></figure><div class="note danger">            <p><font size="5.5" color="red">弊端：</font><br>新表中没有旧表的primary key、auto_increment等属性，需要通过alter进行添加。</p>          </div><h4 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h4><p>如果是想复制出一个一模一样的表，建议使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 查看创建表的sql</span><br><span class="line">SHOW CREATE TABLE 旧表;</span><br><span class="line"></span><br><span class="line">INSERT INTO 新表 SELECT * FROM 旧表;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/article_mariadb.jpeg&quot; alt&gt;&lt;/p&gt;
&lt;div class=&quot;note primary&quot;&gt;
            &lt;p&gt;玩数据的都会涉及数据库，虽然Navicate带来了许多便利，但是本人还是喜欢使用sql，本篇介绍一下关于表复制的相关sql。&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://pygo2.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="Mysql" scheme="http://pygo2.cn/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>Linux-学习之增强篇:crontab</title>
    <link href="http://pygo2.cn/articles/40314/"/>
    <id>http://pygo2.cn/articles/40314/</id>
    <published>2020-04-01T02:11:01.000Z</published>
    <updated>2020-04-01T02:11:01.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Linux-学习之增强篇:firewall-cmd</title>
    <link href="http://pygo2.cn/articles/60013/"/>
    <id>http://pygo2.cn/articles/60013/</id>
    <published>2020-03-28T01:16:18.000Z</published>
    <updated>2020-03-28T01:16:18.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><div class="note danger">            <p>CentOS7开始，默认使用firewall来配置防火墙，没有安装iptables（旧版默认安装）。<br><img src="/images/article_firewall.jpg" alt></p><font color="#dd0000" size="5">时代在更新、CentOS也在更新，我们也必须要更新。</font>          </div><a id="more"></a><hr><p>防火墙没什么好说的，直接开始正餐。</p><h4 id="推荐指数"><a href="#推荐指数" class="headerlink" title="推荐指数"></a>推荐指数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">🌟🌟🌟🌟🌟</span><br></pre></td></tr></table></figure><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install firewalld</span><br></pre></td></tr></table></figure><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><blockquote><p>查看运行状态</p></blockquote><table><thead><tr><th style="text-align:center">command</th></tr></thead><tbody><tr><td style="text-align:center">firewall-cmd –state</td></tr><tr><td style="text-align:center">systemctl status firewalld</td></tr></tbody></table><blockquote><p>启动</p></blockquote><table><thead><tr><th style="text-align:center">function</th><th style="text-align:center">command</th></tr></thead><tbody><tr><td style="text-align:center">开启服务</td><td style="text-align:center">systemctl start firewalld.service</td></tr><tr><td style="text-align:center">关闭服务</td><td style="text-align:center">systemctl stop firewalld.service</td></tr><tr><td style="text-align:center">开机自动启动</td><td style="text-align:center">systemctl enable firewalld.service</td></tr><tr><td style="text-align:center">关闭开机启动</td><td style="text-align:center">systemctl disable firewalld.service</td></tr></tbody></table><blockquote><p>增加端口</p></blockquote><table><thead><tr><th style="text-align:center">function</th><th style="text-align:center">command</th></tr></thead><tbody><tr><td style="text-align:center">永久</td><td style="text-align:center">firewall-cmd –permanent –zone=public –add-port=8080-8081/tcp</td></tr><tr><td style="text-align:center">临时</td><td style="text-align:center">firewall-cmd –zone=public –add-port=8080-8081/tcp</td></tr></tbody></table><ul><li>firewall-cmd：Linux中提供的操作firewall的工具。<br>– zone：指定作用域。<br>– add-port=3306/tcp：添加的端口，格式为：端口/通讯协议。<br>– permanent：表示永久生效，没有此参数重启后会失效。</li></ul><blockquote><p>删除端口</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --remove-port=3306/tcp --permanent</span><br></pre></td></tr></table></figure><p>改变端口即可。</p><blockquote><p>查看端口</p></blockquote><table><thead><tr><th style="text-align:center">function</th><th style="text-align:center">command</th></tr></thead><tbody><tr><td style="text-align:center">简略</td><td style="text-align:center">firewall-cmd –list-ports</td></tr><tr><td style="text-align:center">详情</td><td style="text-align:center">firewall-cmd –list-ports</td></tr></tbody></table><h4 id="其他知识"><a href="#其他知识" class="headerlink" title="其他知识"></a>其他知识</h4><p>关于<strong><em>–zone=public</em></strong>，应该会有人不了解，对<strong>–zone</strong>的参数做个说明：</p><table><thead><tr><th style="text-align:center">type</th><th style="text-align:left">desc</th></tr></thead><tbody><tr><td style="text-align:center">drop</td><td style="text-align:left">任何接受的网络数据包都被丢弃，没有任何回复</td></tr><tr><td style="text-align:center">block</td><td style="text-align:left">任何接收的网络连接都被IPv4的icmp-host-prohibited信息和IPv6的icmp6-adm-prohibited信息所拒绝</td></tr><tr><td style="text-align:center">public</td><td style="text-align:left">在公共区域内使用，不能相信网络内的其他计算机不会对你的计算机造成危害</td></tr><tr><td style="text-align:center">external</td><td style="text-align:left">特别是为路由器启动了伪装功能的外部网</td></tr><tr><td style="text-align:center">dmz</td><td style="text-align:left">用于你的非军事区内的电脑</td></tr><tr><td style="text-align:center">work</td><td style="text-align:left">用于工作区</td></tr><tr><td style="text-align:center">home</td><td style="text-align:left">用于家庭网络</td></tr><tr><td style="text-align:center">internal</td><td style="text-align:left">用于内部网络。你可以基本相信网络内的其他计算机不会危害到你</td></tr><tr><td style="text-align:center">trusted</td><td style="text-align:left">可接受所有的网络连接</td></tr></tbody></table><p>firewalld 的默认zone是public。</p><p>详细了解firewall-cmd，请使用<strong><em>firewall-cmd –help</em></strong>查看。</p><h4 id="特殊说明"><a href="#特殊说明" class="headerlink" title="特殊说明"></a>特殊说明</h4><p>添加完端口之后，记得reload或者重启，重新加载，否则不会生效。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># reload</span><br><span class="line">firewall-cmd --reload</span><br><span class="line"></span><br><span class="line"># restart</span><br><span class="line">#别忘记重启防火墙</span><br><span class="line">systemctl restart firewalld</span><br></pre></td></tr></table></figure></p><p>本人也是属于探索阶段，欢迎大家一起交流，有问题请在博客进行留言。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h3&gt;&lt;div class=&quot;note danger&quot;&gt;
            &lt;p&gt;CentOS7开始，默认使用firewall来配置防火墙，没有安装iptables（旧版默认安装）。&lt;br&gt;&lt;img src=&quot;/images/article_firewall.jpg&quot; alt&gt;&lt;/p&gt;&lt;font color=&quot;#dd0000&quot; size=&quot;5&quot;&gt;时代在更新、CentOS也在更新，我们也必须要更新。&lt;/font&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://pygo2.cn/categories/Linux/"/>
    
    
      <category term="Linux" scheme="http://pygo2.cn/tags/Linux/"/>
    
      <category term="Linux增强篇" scheme="http://pygo2.cn/tags/Linux%E5%A2%9E%E5%BC%BA%E7%AF%87/"/>
    
  </entry>
  
  <entry>
    <title>Linux学习之基础篇-ps</title>
    <link href="http://pygo2.cn/articles/9834/"/>
    <id>http://pygo2.cn/articles/9834/</id>
    <published>2020-02-21T10:45:32.000Z</published>
    <updated>2020-02-21T10:45:32.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/article_linux_ps.jpg" alt></p><blockquote class="blockquote-center"><font size="6.5" color="red">process status</font></blockquote><a id="more"></a><hr><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><div class="note warning">            <p>学习ps的用法【ps 参数】，显示系统进程。</p>          </div><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>Linux中有很多命令可以查询正在运行的进程的信息，其中<strong>ps</strong>与<strong>top</strong>最为常用，至于二者的区别，可以认为ps是当前进程的镜像，是静态的，top可以动态的显示进行信息、内存、CPU等信息。<br>本文讲解ps的用法，至于top的使用会在后续中写出。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><div class="post_cus_note">来个美图  放飞一下</div><p><img src="hushi.jpg" alt></p><div class="post_cus_note">开始正餐</div><h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps [参数]</span><br><span class="line"></span><br><span class="line">ps [参数] | grep [内容]</span><br></pre></td></tr></table></figure><h4 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h4><p>由于ps的参数过多，这里常用的只列举常用参数，如有详细了解请<font color="red" size="5">man进行查询！！！</font>。</p><blockquote><p>-a</p></blockquote><p>显示同一终端下的所有程序。</p><blockquote><p>-A</p></blockquote><p>显示所有进程。</p><blockquote><p>c</p></blockquote><p>显示进程的真实名称。</p><blockquote><p>-C&lt;指令名称&gt; 　</p></blockquote><p>指定执行指令的名称，并列出该指令的进程的状况。</p><blockquote><p>-N</p></blockquote><p>反向选择。</p><blockquote><p>-e</p></blockquote><p>等于“-A”。</p><blockquote><p>e</p></blockquote><p>显示环境变量。</p><blockquote><p>f</p></blockquote><p>显示进程间的相互关系。</p><blockquote><p>-p&lt;进程识别码&gt; 　</p></blockquote><p>指定进程识别码，并列出该进程的状况。</p><blockquote><p>-H</p></blockquote><p>显示树状结构，表示进程间的相互关系。</p><blockquote><p>r</p></blockquote><p>显示当前终端的进程。</p><blockquote><p>-t&lt;终端机编号&gt; 　</p></blockquote><p>指定终端机编号，并列出属于该终端机的进程的状况。</p><blockquote><p>T</p></blockquote><p>显示当前终端的所有程序</p><blockquote><p>u</p></blockquote><p>指定用户的所有进程。</p><blockquote><p>-G&lt;群组识别码&gt;<br>-g&lt;群组识别码&gt;</p></blockquote><p>列出属于该群组的进程的状况，也可使用群组名称来指定。</p><blockquote><p>–help</p></blockquote><p>显示帮助信息。</p><blockquote><p>–version</p></blockquote><p>显示版本显示。</p><h4 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h4><blockquote><p>ps -ef</p></blockquote><p><img src="ef.jpg" alt></p><ul><li>UID：进程拥有者ID</li><li>PID：进程的ID</li><li>PPID：父级进程的ID</li><li>C：进程CPU使用的百分比</li><li>STIME：进程的启动时间</li><li>TTY：登录终端</li><li>TIME：进程使用掉CPU的时间</li><li>CMD：执行的命令</li></ul><blockquote><p>ps -aux</p></blockquote><p><img src="aux.jpg" alt></p><ul><li>USER：用户名</li><li>%CPU：进程占用的CPU百分比</li><li>%MEM：占用内存的百分比</li><li>VSZ：进程使用的虚拟內存量（KB）</li><li>RSS：进程占用的固定內存量（KB）（驻留中页的数量）</li><li>TTY：登录终端</li><li>STAT：进程的状态</li></ul><table><thead><tr><th style="text-align:center">状态码</th><th style="text-align:center">简述</th><th style="text-align:left">详情</th></tr></thead><tbody><tr><td style="text-align:center">D</td><td style="text-align:center">不可中断</td><td style="text-align:left">收到信号不唤醒和不可运行, 进程必须等待直到有中断发生</td></tr><tr><td style="text-align:center">R</td><td style="text-align:center">运行</td><td style="text-align:left">正在运行或在运行队列中等待</td></tr><tr><td style="text-align:center">S</td><td style="text-align:center">中断</td><td style="text-align:left">中断 sleeping</td></tr><tr><td style="text-align:center">T</td><td style="text-align:center">停止或被追踪</td><td style="text-align:left">进程收到SIGSTOP, SIGSTP, SIGTIN, SIGTOU信号后停止运行运行</td></tr><tr><td style="text-align:center">Z</td><td style="text-align:center">僵尸进程</td><td style="text-align:left">进程已终止, 但进程描述符存在, 直到父进程调用wait4()系统调用后释放</td></tr><tr><td style="text-align:center">W</td><td style="text-align:center">内存交换</td><td style="text-align:left">进入内存交换</td></tr></tbody></table><ul><li>START：进程被触发启动时间</li><li>TIME：进程实际使用CPU运行的时间</li><li>COMMAND：执行的命令</li></ul><p>如果需要显示进程的真是名称：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -auxc</span><br></pre></td></tr></table></figure></p><blockquote><p>ps -axjf</p></blockquote><p><img src="axjf.jpg" alt></p><p>信息内容与<strong>ps -aux</strong>差不多，唯一的区别就是在进程COMMAND显示这这块，<strong><em>ps -axjf</em></strong>树形显示进程，比较清晰。</p><blockquote><p>ps -ef -u root</p></blockquote><p>查询指定用户的进程。</p><p><img src="ef.jpg" alt></p><blockquote><p>内容输出</p></blockquote><ul><li><p>文本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef &gt; /home/mingliang.gao/cur_pro.txt</span><br></pre></td></tr></table></figure></li><li><p>翻页</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | less</span><br></pre></td></tr></table></figure></li></ul><h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><blockquote><p>grep</p></blockquote><p>用ps去查询想要的进程，我一般都是配合上<strong><em>grep</em></strong>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 格式</span><br><span class="line">ps -ef | grep &quot;XXXXX&quot;</span><br></pre></td></tr></table></figure></p><blockquote><p>pstree</p></blockquote><p>如果想以树节点形式显示整体的进程，用这个命令，一般系统没有，需要进行安装。</p><ul><li><p>在 Mac OS上</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install pstree</span><br></pre></td></tr></table></figure></li><li><p>在 Fedora/Red Hat/CentOS</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install psmisc</span><br></pre></td></tr></table></figure></li><li><p>在 Ubuntu/Debian</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install psmisc</span><br></pre></td></tr></table></figure></li></ul><h3 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h3><p>菜鸟说明：<a href="https://www.runoob.com/linux/linux-comm-ps.html" target="_blank" rel="noopener">https://www.runoob.com/linux/linux-comm-ps.html</a><br>man手册：<a href="http://man7.org/linux/man-pages/man1/ps.1.html" target="_blank" rel="noopener">http://man7.org/linux/man-pages/man1/ps.1.html</a></p><p>推荐使用man手册，是最全面的文档，在文档的<strong><em>EXAMPLES</em></strong>部分，会有常用的命令。</p><p><img src="examples.jpg" alt></p><font color="red" size="5">希望对大家有所帮助！！！</font>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/article_linux_ps.jpg&quot; alt&gt;&lt;/p&gt;
&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;font size=&quot;6.5&quot; color=&quot;red&quot;&gt;process status&lt;/font&gt;&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://pygo2.cn/categories/Linux/"/>
    
    
      <category term="Linux" scheme="http://pygo2.cn/tags/Linux/"/>
    
      <category term="Linux基础篇" scheme="http://pygo2.cn/tags/Linux%E5%9F%BA%E7%A1%80%E7%AF%87/"/>
    
  </entry>
  
  <entry>
    <title>Python-YouZan数据处理小程序</title>
    <link href="http://pygo2.cn/articles/24462/"/>
    <id>http://pygo2.cn/articles/24462/</id>
    <published>2020-02-14T08:47:27.000Z</published>
    <updated>2020-02-14T08:47:27.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><div class="note primary">            <p>前几天朋友找我问我能不能把人家接口数据存下来，大致需求就是获取YouZan的数据进行存储，存到excel，方便使用。花了大概2days的时间，连查询YouZan官方的API，以及对数据进行一些确认处理，写完了记录下来发布到博客，<font color="red" size="4.5">如果有需求的人，拿走不谢</font>！！！。</p>          </div><p><img src="/images/article_youzan.jpeg" alt></p><a id="more"></a><hr><h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><table><thead><tr><th style="text-align:center">id</th><th style="text-align:center">name</th><th style="text-align:center">Version</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">Python</td><td style="text-align:center">2.7</td></tr></tbody></table><h4 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h4><font color="red" size="5">YouZan -&gt; 获取数据 -&gt; 处理数据 -&gt;存储</font><h4 id="执行方法"><a href="#执行方法" class="headerlink" title="执行方法"></a>执行方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 get_youzan_task.py</span><br></pre></td></tr></table></figure><h4 id="存储方式"><a href="#存储方式" class="headerlink" title="存储方式"></a>存储方式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 数据库</span><br><span class="line">youzan.run(_type=1)</span><br><span class="line"># Excel</span><br><span class="line">youzan.run(_type=2)</span><br></pre></td></tr></table></figure><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">------------------------------------------------</span><br><span class="line">describe:</span><br><span class="line">    先获取可以获取数据的token</span><br><span class="line">    以递增的频率方式进行获取全量数据</span><br><span class="line">    把数据存储到excel或者数据库</span><br><span class="line"></span><br><span class="line">usage:</span><br><span class="line">    python get_youzan.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base_info:</span><br><span class="line">    __version__ = &quot;v.10&quot;</span><br><span class="line">    __author__ = &quot;mingliang.gao&quot;</span><br><span class="line">    __time__ = &quot;2019/9/6&quot;</span><br><span class="line">    __mail__ = &quot;mingliang.gao@qunar.com&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create table sql:</span><br><span class="line">CREATE TABLE `blog`.`client_new` (</span><br><span class="line">    `id` bigint AUTO_INCREMENT NOT NULL,</span><br><span class="line">    `created_at` timestamp NULL COMMENT &apos;\n成为客户的时间，时间戳格式，单位秒\n成为客户的时间\n成为会员的时间&apos;,</span><br><span class="line">    `is_member` tinyint COMMENT &apos;是否是会员\n是否是会员&apos;,</span><br><span class="line">    `name` varchar(254) COMMENT &apos;客户姓名&apos;,</span><br><span class="line">    `show_name` varchar(254) COMMENT &apos;推荐展示姓名&apos;,</span><br><span class="line">    `mobile` varchar(30) COMMENT &apos;手机号&apos;,</span><br><span class="line">    `member_created_at` timestamp NULL COMMENT &apos;\n成为会员的时间，时间戳格式，单位秒&apos;,</span><br><span class="line">    PRIMARY KEY (`id`)</span><br><span class="line">) COMMENT=&apos;&apos;;</span><br><span class="line"></span><br><span class="line">insert test sql:</span><br><span class="line">insert into client(weixin_fans_id, fans_id, created_at, gender, is_member, trade_count, show_name, name, yz_uid, points, mobile, member_created_at)</span><br><span class="line">            VALUES(1111111, 111111, &quot;2020-10-10 00:00:00&quot;, &quot;1&quot;, 1, 2000, &quot;测试22222&quot;, &quot;测试1111&quot;, 22222222, 123123, &quot;123123123123&quot;, &quot;2020-10-10 00:00:00&quot;);</span><br><span class="line">------------------------------------------------</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import os</span><br><span class="line">import datetime</span><br><span class="line">import pymysql</span><br><span class="line">import xlwt</span><br><span class="line">from dateutil.relativedelta import relativedelta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 数据库设置</span><br><span class="line">DB_HOST = &apos;212.64.61.62&apos;</span><br><span class="line">DB_PORT = 3306</span><br><span class="line">DB_USER = &apos;mingliang.gao&apos;</span><br><span class="line">DB_PWD = &apos;XXXXXXXXXXXX&apos;</span><br><span class="line">DB_NAME = &apos;blog&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class YOUZAN_Client(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.YOUZAN_ROOT_URL = &quot;https://open.youzanyun.com&quot;</span><br><span class="line">        self.YOUZAN_TOKEN_URL = &quot;https://open.youzanyun.com/auth/token&quot;</span><br><span class="line">        self.YOUZAN_CLIENT_URL = &quot;https://open.youzanyun.com/api/youzan.scrm.customer.search/3.1.2&quot;</span><br><span class="line"></span><br><span class="line">        # YouZan 客户端ID</span><br><span class="line">        self.CLIENT_ID = &apos;XXXXXX&apos;</span><br><span class="line">        self.CLIENT_SECRET = &apos;XXXXXX&apos;</span><br><span class="line">        self.GRANT_ID = &apos;XXXXXX&apos;</span><br><span class="line"></span><br><span class="line">        self.TOTAL = 0</span><br><span class="line"></span><br><span class="line">        # 配置数据获取的开始时间、结束时间、排除时间</span><br><span class="line">        self.START_DATETIME = &apos;2020-02-01 00:00:00&apos;</span><br><span class="line">        self.END_DATETIME = &apos;2020-02-12 10:00:00&apos;</span><br><span class="line">        self.EXCLUDE_DATETIME = [</span><br><span class="line">            &apos;2020-02-06 22:00:00&apos;,</span><br><span class="line">            &apos;2020-02-06 23:00:00&apos;,</span><br><span class="line">            &apos;2020-02-07 00:00:00&apos;,</span><br><span class="line">            &apos;2020-02-07 01:00:00&apos;,</span><br><span class="line">            &apos;2020-02-07 02:00:00&apos;,</span><br><span class="line">            &apos;2020-02-07 03:00:00&apos;,</span><br><span class="line">            &apos;2020-02-07 04:00:00&apos;,</span><br><span class="line">            &apos;2020-02-07 05:00:00&apos;</span><br><span class="line">        ]</span><br><span class="line">        # 配置excel字段，字段只能从返回数据list中进行选取</span><br><span class="line">        # weixin_fans_id, fans_id, created_at, gender, is_member, trade_count, show_name, name, yz_uid, points, mobile, member_created_at</span><br><span class="line">        self.EXCEL_FIELDS = [&quot;id&quot;, &quot;created_at&quot;, &quot;is_member&quot;, &quot;name&quot;, &quot;show_name&quot;, &apos;mobile&apos;, &apos;member_created_at&apos;]</span><br><span class="line"></span><br><span class="line">        # DB数据库初始化</span><br><span class="line">        self.conn = pymysql.connect(host=DB_HOST,</span><br><span class="line">                                    port=DB_PORT,</span><br><span class="line">                                    user=DB_USER,</span><br><span class="line">                                    password=DB_PWD,</span><br><span class="line">                                    database=DB_NAME,</span><br><span class="line">                                    charset=&apos;utf8&apos;)</span><br><span class="line"></span><br><span class="line">        self.MAX_PAGE_SIZE = 50</span><br><span class="line"></span><br><span class="line">    def add_month(self, transfer_dt, num):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        实现时间上的月份相加</span><br><span class="line">        :param transfer_dt:</span><br><span class="line">        :param num:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if isinstance(transfer_dt, str):</span><br><span class="line">            transfer_dt = datetime.datetime.strptime(transfer_dt, &quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">        return datetime.datetime.strftime(transfer_dt + relativedelta(months=+1), &quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line"></span><br><span class="line">    def deal_time(self, transfer_dt, num, type=&apos;add&apos;, time_type=&apos;day&apos;):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        实现时间上的天数相加相减</span><br><span class="line">        :param transfer_dt:</span><br><span class="line">        :param num:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if type not in [&apos;add&apos;, &apos;min&apos;]:</span><br><span class="line">            return None</span><br><span class="line">        if time_type not in [&apos;days&apos;, &apos;hours&apos;, &apos;minutes&apos;, &apos;seconds&apos;]:</span><br><span class="line">            return None</span><br><span class="line"></span><br><span class="line">        num = num if type == &apos;add&apos; else -num</span><br><span class="line">        if isinstance(transfer_dt, str):</span><br><span class="line">            transfer_dt = datetime.datetime.strptime(transfer_dt, &quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line"></span><br><span class="line">        if time_type == &apos;day&apos;:</span><br><span class="line">            return (transfer_dt + datetime.timedelta(days=num)).strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">        elif time_type == &apos;hours&apos;:</span><br><span class="line">            return (transfer_dt + datetime.timedelta(hours=num)).strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">        elif time_type == &apos;minutes&apos;:</span><br><span class="line">            return (transfer_dt + datetime.timedelta(minutes=num)).strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">        elif time_type == &apos;seconds&apos;:</span><br><span class="line">            return (transfer_dt + datetime.timedelta(seconds=num)).strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line"></span><br><span class="line">    def _check_token_expire(self, token_time):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        check token is or expire</span><br><span class="line">        :param token_time:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if not token_time:</span><br><span class="line">            return False, &apos;过期时间为null&apos;</span><br><span class="line"></span><br><span class="line">        # 获取的时间为毫秒</span><br><span class="line">        token_date_time = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime(token_time/1000))</span><br><span class="line">        now_time = datetime.datetime.now().strftime(&apos;%Y-%m-%d %H:%M:%S&apos;)</span><br><span class="line">        return (True, token_date_time) if now_time &lt; token_date_time \</span><br><span class="line">            else (False, token_date_time)</span><br><span class="line"></span><br><span class="line">    def get_token(self):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        get available token from youzan</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        payload = &#123;</span><br><span class="line">            &quot;client_id&quot;: self.CLIENT_ID,</span><br><span class="line">            &quot;client_secret&quot;: self.CLIENT_SECRET,</span><br><span class="line">            &quot;authorize_type&quot;: &quot;silent&quot;,</span><br><span class="line">            &quot;grant_id&quot;: self.GRANT_ID</span><br><span class="line">        &#125;</span><br><span class="line">        headers = &#123;</span><br><span class="line">            &apos;Content-Type&apos;: &quot;application/json&quot;,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        try:</span><br><span class="line">            token_resp = requests.post(url=self.YOUZAN_TOKEN_URL,</span><br><span class="line">                                       headers=headers,</span><br><span class="line">                                       json=payload)</span><br><span class="line">            if token_resp.status_code != 200:</span><br><span class="line">                return False, &apos;token请求失败&apos;</span><br><span class="line">            token_resp_json = token_resp.json()</span><br><span class="line">            if not token_resp_json:</span><br><span class="line">                return False, &apos;token无json数据&apos;</span><br><span class="line"></span><br><span class="line">            is_ok = token_resp_json.get(&apos;success&apos;)</span><br><span class="line">            if not is_ok:</span><br><span class="line">                return False, &apos;token json success为false&apos;</span><br><span class="line"></span><br><span class="line">            token_time = token_resp_json.get(&apos;data&apos;).get(&apos;expires&apos;)</span><br><span class="line">            is_ok, token_expires = self._check_token_expire(token_time)</span><br><span class="line">            if not is_ok:</span><br><span class="line">                return False, &apos;token过期：%s&apos; % token_expires</span><br><span class="line"></span><br><span class="line">            return True, token_resp_json.get(&apos;data&apos;).get(&apos;access_token&apos;)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, &apos;token请求Exception失败: %s&apos; % e.message</span><br><span class="line"></span><br><span class="line">    def _transfer_to_time(self, timeStamp, t_type=1):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        type=1 把时间戳转换成datetime str类型</span><br><span class="line">        type=2 把datetime类型/datetime str类型转换成时间戳</span><br><span class="line"></span><br><span class="line">        :param timeStamp: dateTime or timeStamp</span><br><span class="line">        :param t_type: 1 or 2</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if t_type == 2:</span><br><span class="line">            if isinstance(timeStamp, str):</span><br><span class="line">                timeStamp = time.strptime(timeStamp, &quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">            return int(time.mktime(timeStamp))</span><br><span class="line"></span><br><span class="line">        if isinstance(timeStamp, str):</span><br><span class="line">            timeStamp = int(timeStamp)</span><br><span class="line">        return time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime(timeStamp))</span><br><span class="line"></span><br><span class="line">    def set_style(self, name, height, bold=False):</span><br><span class="line">        style = xlwt.XFStyle()</span><br><span class="line">        font = xlwt.Font()</span><br><span class="line">        font.name = name</span><br><span class="line">        font.bold = bold</span><br><span class="line">        font.color_index = 4</span><br><span class="line">        font.height = height</span><br><span class="line">        style.font = font</span><br><span class="line">        return style</span><br><span class="line"></span><br><span class="line">    def _deal_client_to_excel(self, datas):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        :param datas: client object to excel</span><br><span class="line">        :return: None</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if not datas:</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">        f = xlwt.Workbook(encoding=&apos;utf-8&apos;)</span><br><span class="line">        sheet = f.add_sheet(&apos;sheet&apos;, cell_overwrite_ok=True)</span><br><span class="line"></span><br><span class="line">        title_style = self.set_style(&apos;Times New Roman&apos;, 220, True)</span><br><span class="line">        content_style = self.set_style(&apos;Times New Roman&apos;, 220, False)</span><br><span class="line">        # 标题</span><br><span class="line">        for i in range(0, len(self.EXCEL_FIELDS)):</span><br><span class="line">            sheet.write(0, i, self.EXCEL_FIELDS[i], title_style)</span><br><span class="line"></span><br><span class="line">        row = 1</span><br><span class="line"></span><br><span class="line">        for data in datas:</span><br><span class="line">            if not data:</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            weixin_fans_id = data.get(&apos;weixin_fans_id&apos;)</span><br><span class="line">            fans_id = data.get(&apos;fans_id&apos;)</span><br><span class="line">            created_at = self._transfer_to_time(data.get(&apos;created_at&apos;)) \</span><br><span class="line">                if data.get(&apos;created_at&apos;) else &apos;&apos;</span><br><span class="line">            member_created_at = self._transfer_to_time(data.get(&apos;member_created_at&apos;)) \</span><br><span class="line">                if data.get(&apos;created_at&apos;) else &apos;&apos;</span><br><span class="line">            gender = data.get(&apos;gender&apos;)</span><br><span class="line">            is_member = data.get(&apos;is_member&apos;)</span><br><span class="line">            trade_count = data.get(&apos;trade_count&apos;)</span><br><span class="line">            show_name = data.get(&apos;show_name&apos;)</span><br><span class="line">            name = data.get(&apos;name&apos;)</span><br><span class="line">            yz_uid = data.get(&apos;yz_uid&apos;)</span><br><span class="line">            points = data.get(&apos;points&apos;)</span><br><span class="line">            mobile = data.get(&apos;mobile&apos;)</span><br><span class="line"></span><br><span class="line">            if isinstance(show_name, unicode):</span><br><span class="line">                show_name = show_name.encode(&apos;utf-8&apos;)</span><br><span class="line">            if isinstance(mobile, unicode):</span><br><span class="line">                mobile = mobile.encode(&apos;utf-8&apos;)</span><br><span class="line">            if isinstance(created_at, unicode):</span><br><span class="line">                created_at = created_at.encode(&apos;utf-8&apos;)</span><br><span class="line">            if isinstance(member_created_at, unicode):</span><br><span class="line">                member_created_at = member_created_at.encode(&apos;utf-8&apos;)</span><br><span class="line">            if isinstance(name, unicode):</span><br><span class="line">                name = name.encode(&apos;utf-8&apos;)</span><br><span class="line">            if isinstance(mobile, unicode):</span><br><span class="line">                mobile = mobile.encode(&apos;utf-8&apos;)</span><br><span class="line"></span><br><span class="line">            for field in self.EXCEL_FIELDS:</span><br><span class="line">                if field == &apos;id&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), row, title_style)</span><br><span class="line">                elif field == &apos;weixin_fans_id&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), weixin_fans_id, content_style)</span><br><span class="line">                elif field == &apos;fans_id&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), fans_id, content_style)</span><br><span class="line">                elif field == &apos;created_at&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), created_at, content_style)</span><br><span class="line">                elif field == &apos;member_created_at&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), member_created_at, content_style)</span><br><span class="line">                elif field == &apos;gender&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), gender, content_style)</span><br><span class="line">                elif field == &apos;is_member&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), is_member, content_style)</span><br><span class="line">                elif field == &apos;trade_count&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), trade_count, content_style)</span><br><span class="line">                elif field == &apos;show_name&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), show_name, content_style)</span><br><span class="line">                elif field == &apos;name&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), name, content_style)</span><br><span class="line">                elif field == &apos;yz_uid&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), yz_uid, content_style)</span><br><span class="line">                elif field == &apos;points&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), points, content_style)</span><br><span class="line">                elif field == &apos;mobile&apos;:</span><br><span class="line">                    sheet.write(row, self.EXCEL_FIELDS.index(field), mobile, content_style)</span><br><span class="line">            row += 1</span><br><span class="line"></span><br><span class="line">        f.save(&apos;%s-%s名单.xls&apos; % (self.START_DATETIME, self.END_DATETIME))</span><br><span class="line"></span><br><span class="line">    def _deal_client_to_db(self, data):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        :param data: client object to database</span><br><span class="line">        :return: None</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if not data:</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">        weixin_fans_id = data.get(&apos;weixin_fans_id&apos;)</span><br><span class="line">        fans_id = data.get(&apos;fans_id&apos;)</span><br><span class="line">        created_at = self._transfer_to_time(data.get(&apos;created_at&apos;)) \</span><br><span class="line">            if data.get(&apos;created_at&apos;) else &apos;&apos;</span><br><span class="line">        member_created_at = self._transfer_to_time(data.get(&apos;member_created_at&apos;)) \</span><br><span class="line">            if data.get(&apos;created_at&apos;) else &apos;&apos;</span><br><span class="line">        gender = data.get(&apos;gender&apos;)</span><br><span class="line">        is_member = data.get(&apos;is_member&apos;)</span><br><span class="line">        trade_count = data.get(&apos;trade_count&apos;)</span><br><span class="line">        show_name = data.get(&apos;show_name&apos;)</span><br><span class="line">        name = data.get(&apos;name&apos;)</span><br><span class="line">        yz_uid = data.get(&apos;yz_uid&apos;)</span><br><span class="line">        points = data.get(&apos;points&apos;)</span><br><span class="line">        mobile = data.get(&apos;mobile&apos;)</span><br><span class="line"></span><br><span class="line">        if isinstance(show_name, unicode):</span><br><span class="line">            show_name = show_name.encode(&apos;utf-8&apos;)</span><br><span class="line">        if isinstance(mobile, unicode):</span><br><span class="line">            mobile = mobile.encode(&apos;utf-8&apos;)</span><br><span class="line">        if isinstance(created_at, unicode):</span><br><span class="line">            created_at = created_at.encode(&apos;utf-8&apos;)</span><br><span class="line">        if isinstance(member_created_at, unicode):</span><br><span class="line">            member_created_at = member_created_at.encode(&apos;utf-8&apos;)</span><br><span class="line">        if isinstance(name, unicode):</span><br><span class="line">            name = name.encode(&apos;utf-8&apos;)</span><br><span class="line">        if isinstance(mobile, unicode):</span><br><span class="line">            mobile = mobile.encode(&apos;utf-8&apos;)</span><br><span class="line"></span><br><span class="line">        # insert_sql = &quot;&quot;&quot;</span><br><span class="line">        # insert into client(weixin_fans_id, fans_id, created_at, gender, is_member, trade_count, show_name, name, yz_uid, points, mobile, member_created_at)</span><br><span class="line">        # VALUES(%s, %s, &quot;%s&quot;, &quot;%s&quot;, %s, %s, &quot;%s&quot;, &quot;%s&quot;, %s, %s, &quot;%s&quot;, &quot;%s&quot;);</span><br><span class="line">        # &quot;&quot;&quot; % (weixin_fans_id, fans_id, created_at, gender, is_member, trade_count, show_name, name, yz_uid, points, mobile, member_created_at)</span><br><span class="line">        insert_sql = &apos;insert into client_new(created_at, is_member, name, show_name, mobile, member_created_at) VALUES(%s, %s, %s, %s, %s, %s);&apos;</span><br><span class="line">        cursor = self.conn.cursor()</span><br><span class="line">        cursor.execute(insert_sql, (created_at, is_member, name, show_name, mobile, member_created_at))</span><br><span class="line">        self.conn.commit()</span><br><span class="line">        cursor.close()</span><br><span class="line"></span><br><span class="line">    def deal_client_by_token(self, token, store):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        main method by token</span><br><span class="line">        设置一个起始时间，每次递增加1月进行数据获取，以此方式进行all data获取</span><br><span class="line">        :param token:</span><br><span class="line">        :param store: db or excel</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">        all_datas = list()</span><br><span class="line">        end_time = self.START_DATETIME</span><br><span class="line"></span><br><span class="line">        while True:</span><br><span class="line">            start_time = end_time</span><br><span class="line">            if start_time == self.END_DATETIME:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">            end_time = self.deal_time(start_time, 1, &apos;add&apos;, &apos;hours&apos;)</span><br><span class="line">            # 去掉脏数据时间段</span><br><span class="line">            if start_time in self.EXCLUDE_DATETIME:</span><br><span class="line">                print &apos;【%s】is exclude datetime&apos; % start_time</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            payload = &#123;</span><br><span class="line">                # &quot;is_member&quot;: 1,   # 是否会员</span><br><span class="line">                &quot;created_at_start&quot;: self._transfer_to_time(start_time, 2),     # 成为客户的时间</span><br><span class="line">                &quot;created_at_end&quot;: self._transfer_to_time(end_time, 2)     # 成为客户的时间</span><br><span class="line">            &#125;</span><br><span class="line">            headers = &#123;</span><br><span class="line">                &apos;Content-Type&apos;: &quot;multipart/form-data&quot;,</span><br><span class="line">            &#125;</span><br><span class="line">            real_url = &apos;%s?access_token=%s&apos; % (self.YOUZAN_CLIENT_URL, token)</span><br><span class="line">            data_resp = requests.post(url=real_url,</span><br><span class="line">                                      # headers=headers,</span><br><span class="line">                                      data=payload)</span><br><span class="line"></span><br><span class="line">            if data_resp.status_code != 200:</span><br><span class="line">                print &apos;【%s】client请求失败&apos; % start_time</span><br><span class="line">                continue</span><br><span class="line">            resp_json_datas = data_resp.json()</span><br><span class="line">            if not resp_json_datas:</span><br><span class="line">                print &apos;【%s】client无json数据&apos; % start_time</span><br><span class="line">                continue</span><br><span class="line">            code = resp_json_datas.get(&apos;code&apos;)</span><br><span class="line">            if code != 200:</span><br><span class="line">                print &apos;【%s】client code is error: %s&apos; % (start_time, code)</span><br><span class="line">                continue</span><br><span class="line">            total = resp_json_datas.get(&apos;data&apos;).get(&apos;total&apos;)</span><br><span class="line">            if total &lt; 1:</span><br><span class="line">                print &apos;【%s】client json数据total: %s&apos; % (start_time, total)</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            # 特别说2 = 1 + 1，有一个page页面的1，还有一个range的1</span><br><span class="line">            page = int(total / 50) + 2</span><br><span class="line">            self.TOTAL = self.TOTAL + total</span><br><span class="line">            print &apos;%s - %s total: %s, page: %s&apos; \</span><br><span class="line">                  % (start_time, end_time, total, (page - 1))</span><br><span class="line"></span><br><span class="line">            for i in range(1, page, 1):</span><br><span class="line">                print &apos;===========%s&apos; % i</span><br><span class="line">                sub_payload = &#123;</span><br><span class="line">                    &quot;created_at_start&quot;: self._transfer_to_time(start_time, 2),     # 成为客户的时间</span><br><span class="line">                    &quot;created_at_end&quot;: self._transfer_to_time(end_time, 2),     # 成为客户的时间</span><br><span class="line">                    &quot;page_size&quot;: self.MAX_PAGE_SIZE     # 每页数量，最多支持50个</span><br><span class="line">                &#125;</span><br><span class="line">                sub_data_resp = requests.post(url=real_url,</span><br><span class="line">                                              data=sub_payload)</span><br><span class="line">                sub_resp_json_datas = sub_data_resp.json()</span><br><span class="line">                datas = sub_resp_json_datas.get(&apos;data&apos;).get(&apos;record_list&apos;)</span><br><span class="line">                for data in datas:</span><br><span class="line">                    if not data:</span><br><span class="line">                        continue</span><br><span class="line">                    self._deal_client_to_db(data) if store == &apos;db&apos; \</span><br><span class="line">                        else all_datas.append(data)</span><br><span class="line"></span><br><span class="line">        if store == &apos;excel&apos;:</span><br><span class="line">            self._deal_client_to_excel(all_datas)</span><br><span class="line"></span><br><span class="line">    def run(self, _type=1):</span><br><span class="line">        store = &apos;db&apos; if _type == 1 else &apos;excel&apos;</span><br><span class="line">        is_ok, message = self.get_token()</span><br><span class="line">        if not is_ok:</span><br><span class="line">            print &apos;YouZan token获取失败：【%s】&apos; % message</span><br><span class="line">            os._exit()</span><br><span class="line"></span><br><span class="line">        print &apos;token: %s&apos; % message</span><br><span class="line">        self.deal_client_by_token(message, store)</span><br><span class="line">        if store == &apos;db&apos;:</span><br><span class="line">            youzan.conn.close()</span><br><span class="line">        print &apos;===================end: %s&apos; % self.TOTAL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line"></span><br><span class="line">    youzan = YOUZAN_Client()</span><br><span class="line">    youzan.run(_type=2)</span><br></pre></td></tr></table></figure><p><img src="py.jpeg" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h4&gt;&lt;div class=&quot;note primary&quot;&gt;
            &lt;p&gt;前几天朋友找我问我能不能把人家接口数据存下来，大致需求就是获取YouZan的数据进行存储，存到excel，方便使用。花了大概2days的时间，连查询YouZan官方的API，以及对数据进行一些确认处理，写完了记录下来发布到博客，&lt;font color=&quot;red&quot; size=&quot;4.5&quot;&gt;如果有需求的人，拿走不谢&lt;/font&gt;！！！。&lt;/p&gt;
          &lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/images/article_youzan.jpeg&quot; alt&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="http://pygo2.cn/categories/Python/"/>
    
    
      <category term="Python" scheme="http://pygo2.cn/tags/Python/"/>
    
      <category term="Python程序篇" scheme="http://pygo2.cn/tags/Python%E7%A8%8B%E5%BA%8F%E7%AF%87/"/>
    
  </entry>
  
  <entry>
    <title>行尸走肉</title>
    <link href="http://pygo2.cn/articles/21862/"/>
    <id>http://pygo2.cn/articles/21862/</id>
    <published>2020-01-09T03:19:04.000Z</published>
    <updated>2020-01-09T03:19:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/article_xingshizourou.jpeg" alt></p><div class="post_cus_note">《行尸走肉》</div><a id="more"></a><hr><div class="note success">            <font size="4" color="red"><strong>简介</strong></font><br>《行尸走肉》（The walking dead），是一部美国恐怖电视系列剧，改编自同名漫画，始于2010年10月31日在AMC有线电视网开播，是电视史上第一部正宗的丧尸电视剧。<br><font color="red" size="5">如果你喜欢丧尸剧，那么这个绝对是你的菜！！！</font>          </div><blockquote><p>推荐指数</p></blockquote><pre><code>⭐️⭐️⭐️⭐️⭐️</code></pre><blockquote><p>人物角色</p></blockquote><p>男主（前八季）：<a href="https://baike.baidu.com/item/%E7%91%9E%E5%85%8B%C2%B7%E6%A0%BC%E8%8E%B1%E5%A7%86%E6%96%AF" target="_blank" rel="noopener"><strong><em>瑞克·格莱姆斯</em></strong></a><br>男二：<a href="https://baike.baidu.com/item/%E8%BE%BE%E9%87%8C%E5%B0%94%C2%B7%E8%BF%AA%E5%85%8B%E6%A3%AE/22218077?fromtitle=%E8%BE%BE%E9%87%8C%E5%B0%94&amp;fromid=16985070" target="_blank" rel="noopener"><strong><em>达里尔·迪克森(弩哥)</em></strong></a><br>女二：<a href="https://baike.baidu.com/item/%E6%A2%85%E4%B8%BD%E8%8E%8E%C2%B7%E9%BA%A6%E5%85%8B%E5%B8%83%E8%8E%B1%E5%BE%B7/16413532?fromtitle=%E6%A2%85%E4%B8%BD%E8%8E%8E%C2%B7%E8%8B%8F%E5%A7%97%E5%A6%AE%C2%B7%E9%BA%A6%E5%85%8B%E5%B8%83%E8%8E%B1%E5%BE%B7&amp;fromid=16282064" target="_blank" rel="noopener"><strong><em>卡萝尔(卡妈)</em></strong></a><br>男主（8、9、10季）：<a href="https://baike.baidu.com/item/%E6%9D%B0%E5%BC%97%E9%87%8C%C2%B7%E8%BF%AA%E6%81%A9%C2%B7%E6%91%A9%E6%A0%B9" target="_blank" rel="noopener"><strong><em>Negan(尼根)</em></strong></a></p><p>人物实在是太多了，这里只列举了我比较喜欢的几个人。</p><blockquote><p>主线剧情</p></blockquote><p>世界突然变成充满丧尸的世界，但是人必须需要活下去，由瑞克带领的团队与<strong><em>丧尸、总督、食人族、低语者</em></strong>等等一系列团队进行斗争。<br>前几季丧尸比较牛逼的，后来全都是人与人之间的争斗。</p><blockquote><p>观后感</p></blockquote><p><strong><em><font color="#dd0000" size="5">如果我是瑞克，我该怎么做？真是人性的考验！！！</font></em></strong></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/article_xingshizourou.jpeg&quot; alt&gt;&lt;/p&gt;

&lt;div class=&quot;post_cus_note&quot;&gt;《行尸走肉》&lt;/div&gt;
    
    </summary>
    
      <category term="影视说" scheme="http://pygo2.cn/categories/%E5%BD%B1%E8%A7%86%E8%AF%B4/"/>
    
    
      <category term="电视剧" scheme="http://pygo2.cn/tags/%E7%94%B5%E8%A7%86%E5%89%A7/"/>
    
      <category term="美国大片" scheme="http://pygo2.cn/tags/%E7%BE%8E%E5%9B%BD%E5%A4%A7%E7%89%87/"/>
    
  </entry>
  
  <entry>
    <title>元旦节【&lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;中国节&lt;/font&gt;】</title>
    <link href="http://pygo2.cn/articles/33336/"/>
    <id>http://pygo2.cn/articles/33336/</id>
    <published>2020-01-01T08:46:55.000Z</published>
    <updated>2020-01-01T08:46:55.000Z</updated>
    
    <content type="html"><![CDATA[<div class="post_cus_note">中国节-元旦节</div><p><img src="/images/article_jieri_yuandan.jpeg" alt></p><font size="6.5" color="red">持续更新中。。。。。。</font><a id="more"></a><hr><table><thead><tr><th style="text-align:center">时间</th><th style="text-align:center">地点</th></tr></thead><tbody><tr><td style="text-align:center">2020-01-01</td><td style="text-align:center">保康</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;post_cus_note&quot;&gt;中国节-元旦节&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/article_jieri_yuandan.jpeg&quot; alt&gt;&lt;/p&gt;
&lt;font size=&quot;6.5&quot; color=&quot;red&quot;&gt;持续更新中。。。。。。&lt;/font&gt;
    
    </summary>
    
      <category term="节日" scheme="http://pygo2.cn/categories/%E8%8A%82%E6%97%A5/"/>
    
    
      <category term="节日" scheme="http://pygo2.cn/tags/%E8%8A%82%E6%97%A5/"/>
    
      <category term="中国节" scheme="http://pygo2.cn/tags/%E4%B8%AD%E5%9B%BD%E8%8A%82/"/>
    
  </entry>
  
  <entry>
    <title>Python-判断PC是否连网</title>
    <link href="http://pygo2.cn/articles/19515/"/>
    <id>http://pygo2.cn/articles/19515/</id>
    <published>2019-12-31T02:34:17.000Z</published>
    <updated>2019-12-31T02:34:17.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/article_python_socket.jpeg" alt></p><div class="post_cus_note">life is short, me use Python.</div><p>2019年的最后一片技术博客了，写一个初始学Python的知识点，在这里先祝<font size="6.5" color="red">【大家元旦快乐】</font>。<br><a id="more"></a></p><hr><p>代码很简单，需要设置能访问的url即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line"></span><br><span class="line">def is_connected(url):</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    host = socket.gethostbyname(url)</span><br><span class="line">    s = socket.create_connection((host, 80), 2)</span><br><span class="line">    return True</span><br><span class="line">except Exception as e:</span><br><span class="line">    return False</span><br><span class="line">URL = &quot;www.baidu.com&quot;</span><br><span class="line"></span><br><span class="line">print is_connected(URL )</span><br></pre></td></tr></table></figure><font size="6.5" color="red">此代码写于2016-09-12。。。。。。【自学Python期间】</font><div class="post_cus_note">其他方式</div><blockquote><p>curl</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://www.baidu.com</span><br></pre></td></tr></table></figure><blockquote><p>wget</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.baidu.com</span><br></pre></td></tr></table></figure><font size="6.5" color="blue">生命不息，奋斗不止！</font>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/article_python_socket.jpeg&quot; alt&gt;&lt;/p&gt;

&lt;div class=&quot;post_cus_note&quot;&gt;life is short, me use Python.&lt;/div&gt;

&lt;p&gt;2019年的最后一片技术博客了，写一个初始学Python的知识点，在这里先祝&lt;font size=&quot;6.5&quot; color=&quot;red&quot;&gt;【大家元旦快乐】&lt;/font&gt;。&lt;br&gt;
    
    </summary>
    
      <category term="Python" scheme="http://pygo2.cn/categories/Python/"/>
    
    
      <category term="Python" scheme="http://pygo2.cn/tags/Python/"/>
    
      <category term="Python程序篇" scheme="http://pygo2.cn/tags/Python%E7%A8%8B%E5%BA%8F%E7%AF%87/"/>
    
      <category term="Python基础篇" scheme="http://pygo2.cn/tags/Python%E5%9F%BA%E7%A1%80%E7%AF%87/"/>
    
  </entry>
  
  <entry>
    <title>Github热门的Python项目推荐</title>
    <link href="http://pygo2.cn/articles/12867/"/>
    <id>http://pygo2.cn/articles/12867/</id>
    <published>2019-12-27T02:27:58.000Z</published>
    <updated>2019-12-27T02:27:58.000Z</updated>
    
    <content type="html"><![CDATA[<div class="post_cus_note">推荐几款Github上热门的Python项目</div><p><img src="/images/article_github.jpg" alt></p><font size="6.5" color="red">持续更新中。。。。。。</font><a id="more"></a><hr><table><thead><tr><th style="text-align:center">NAME</th><th style="text-align:center">URL</th></tr></thead><tbody><tr><td style="text-align:center">抢票神器（web版）</td><td style="text-align:center"><a href="https://github.com/pjialin/py12306/" target="_blank" rel="noopener">https://github.com/pjialin/py12306/</a></td></tr><tr><td style="text-align:center">实时GPS接数处理程序</td><td style="text-align:center"><a href="https://github.com/GIS90/realgpserver.git" target="_blank" rel="noopener">https://github.com/GIS90/realgpserver.git</a></td></tr><tr><td style="text-align:center">自由上网</td><td style="text-align:center"><a href="https://github.com/Alvin9999/new-pac.git" target="_blank" rel="noopener">https://github.com/Alvin9999/new-pac.git</a></td></tr><tr><td style="text-align:center">爬虫集合</td><td style="text-align:center"><a href="https://github.com/facert/awesome-spider.git" target="_blank" rel="noopener">https://github.com/facert/awesome-spider.git</a></td></tr><tr><td style="text-align:center">年会抽奖</td><td style="text-align:center"><a href="https://github.com/fouber/lottery.git" target="_blank" rel="noopener">https://github.com/fouber/lottery.git</a></td></tr></tbody></table><p>从事于Python语言开发。。。。。。</p>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;post_cus_note&quot;&gt;推荐几款Github上热门的Python项目&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/article_github.jpg&quot; alt&gt;&lt;/p&gt;
&lt;font size=&quot;6.5&quot; color=&quot;red&quot;&gt;持续更新中。。。。。。&lt;/font&gt;
    
    </summary>
    
      <category term="Python" scheme="http://pygo2.cn/categories/Python/"/>
    
    
      <category term="Python" scheme="http://pygo2.cn/tags/Python/"/>
    
      <category term="Github" scheme="http://pygo2.cn/tags/Github/"/>
    
  </entry>
  
  <entry>
    <title>etherpad在线协作编辑</title>
    <link href="http://pygo2.cn/articles/7544/"/>
    <id>http://pygo2.cn/articles/7544/</id>
    <published>2019-12-24T07:24:47.000Z</published>
    <updated>2019-12-24T07:24:47.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/article_etherpad.jpg" alt></p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><div class="note primary">            <p>官网：Etherpad is a highly customizable Open Source online editor providing collaborative editing in really real-time.</p><p>个人翻译：Etherpad是一款定制、开源的在线编辑器，提供实时协作编辑。</p>          </div><a id="more"></a><hr><h3 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h3><p><img src="version.png" alt></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>本人实践的机器是阿里云服务器，系统是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[mingliang.gao@VM_0_16_centos ~]$ cat /etc/*release*</span><br><span class="line"></span><br><span class="line">CentOS Linux release 7.5.1804 (Core)</span><br><span class="line">Derived from Red Hat Enterprise Linux 7.5 (Source)</span><br><span class="line">NAME=&quot;CentOS Linux&quot;</span><br><span class="line">VERSION=&quot;7 (Core)&quot;</span><br><span class="line">ID=&quot;centos&quot;</span><br><span class="line">ID_LIKE=&quot;rhel fedora&quot;</span><br><span class="line">VERSION_ID=&quot;7&quot;</span><br><span class="line">PRETTY_NAME=&quot;CentOS Linux 7 (Core)&quot;</span><br><span class="line">ANSI_COLOR=&quot;0;31&quot;</span><br><span class="line">CPE_NAME=&quot;cpe:/o:centos:centos:7&quot;</span><br><span class="line">HOME_URL=&quot;https://www.centos.org/&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.centos.org/&quot;</span><br><span class="line"></span><br><span class="line">CENTOS_MANTISBT_PROJECT=&quot;CentOS-7&quot;</span><br><span class="line">CENTOS_MANTISBT_PROJECT_VERSION=&quot;7&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT=&quot;centos&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT_VERSION=&quot;7&quot;</span><br><span class="line"></span><br><span class="line">CentOS Linux release 7.5.1804 (Core)</span><br><span class="line">CentOS Linux release 7.5.1804 (Core)</span><br><span class="line">cpe:/o:centos:centos:7</span><br></pre></td></tr></table></figure></p><h4 id="node环境"><a href="#node环境" class="headerlink" title="node环境"></a>node环境</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 安装</span><br><span class="line">yum install -y nodejs</span><br><span class="line"></span><br><span class="line"># check</span><br><span class="line">node -v</span><br></pre></td></tr></table></figure><h4 id="依赖包"><a href="#依赖包" class="headerlink" title="依赖包"></a>依赖包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install curl vim gcc-c++ make</span><br></pre></td></tr></table></figure><h4 id="MariaDB数据库安装与配置"><a href="#MariaDB数据库安装与配置" class="headerlink" title="MariaDB数据库安装与配置"></a>MariaDB数据库安装与配置</h4><blockquote><p>安装</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mariadb-server</span><br></pre></td></tr></table></figure><p>执行过程略，在安装过程中会让出现root密码等设置，具体请参考文章最后的MariaDB安装与配置，进行下一步启动。</p><blockquote><p>启动</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 开启mariadb数据库</span><br><span class="line">systemctl start mariadb.service</span><br><span class="line"></span><br><span class="line"># 设置开机自动启动</span><br><span class="line">systemctl enable mariadb.service</span><br></pre></td></tr></table></figure><blockquote><p>首次安装</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_16_centos conf.d]#  mysql_secure_installation</span><br><span class="line"></span><br><span class="line">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span><br><span class="line">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class="line"></span><br><span class="line">In order to log into MariaDB to secure it, we&apos;ll need the current</span><br><span class="line">password for the root user.  If you&apos;ve just installed MariaDB, and</span><br><span class="line">you haven&apos;t set the root password yet, the password will be blank,</span><br><span class="line">so you should just press enter here.</span><br><span class="line"></span><br><span class="line">Enter current password for root (enter for none):</span><br><span class="line">ERROR 1045 (28000): Access denied for user &apos;root&apos;@&apos;localhost&apos; (using password: YES)</span><br><span class="line">Enter current password for root (enter for none):</span><br><span class="line">ERROR 1045 (28000): Access denied for user &apos;root&apos;@&apos;localhost&apos; (using password: YES)</span><br><span class="line">Enter current password for root (enter for none):</span><br><span class="line">OK, successfully used password, moving on...</span><br><span class="line"></span><br><span class="line">Setting the root password ensures that nobody can log into the MariaDB</span><br><span class="line">root user without the proper authorisation.</span><br><span class="line"></span><br><span class="line">Set root password? [Y/n] y</span><br><span class="line">New password:</span><br><span class="line">Re-enter new password:</span><br><span class="line">Password updated successfully!</span><br><span class="line">Reloading privilege tables..</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">By default, a MariaDB installation has an anonymous user, allowing anyone</span><br><span class="line">to log into MariaDB without having to have a user account created for</span><br><span class="line">them.  This is intended only for testing, and to make the installation</span><br><span class="line">go a bit smoother.  You should remove them before moving into a</span><br><span class="line">production environment.</span><br><span class="line"></span><br><span class="line">Remove anonymous users? [Y/n] n</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">Normally, root should only be allowed to connect from &apos;localhost&apos;.  This</span><br><span class="line">ensures that someone cannot guess at the root password from the network.</span><br><span class="line"></span><br><span class="line">Disallow root login remotely? [Y/n] n</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">By default, MariaDB comes with a database named &apos;test&apos; that anyone can</span><br><span class="line">access.  This is also intended only for testing, and should be removed</span><br><span class="line">before moving into a production environment.</span><br><span class="line"></span><br><span class="line">Remove test database and access to it? [Y/n] n</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">Reloading the privilege tables will ensure that all changes made so far</span><br><span class="line">will take effect immediately.</span><br><span class="line"></span><br><span class="line">Reload privilege tables now? [Y/n] y</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line">Cleaning up...</span><br><span class="line"></span><br><span class="line">All done!  If you&apos;ve completed all of the above steps, your MariaDB</span><br><span class="line">installation should now be secure.</span><br><span class="line"></span><br><span class="line">Thanks for using MariaDB!</span><br></pre></td></tr></table></figure><p>完成初始化设置，主要是root密码的设置最重要。</p><blockquote><p>连接</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h 127.0.0.1 -P 3306 -u root -p</span><br></pre></td></tr></table></figure><p>具体mysql命令怎么使用这里也不做解释，不知道的请自行查资料。</p><blockquote><p>配置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; CREATE DATABASE etherpad;</span><br><span class="line">MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON etherpad.* TO &apos;etherpad&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;123456&apos;;</span><br><span class="line">MariaDB [(none)]&gt; FLUSH PRIVILEGES;</span><br><span class="line">MariaDB [(none)]&gt; \q</span><br></pre></td></tr></table></figure><p>在这里操作是创建etherpad数据库，以及etherpad用户并分配etherpad用户有访问etherpad数据库的权限，用户名：etherpad，密码：123456。<br>关于数据库、用户、密码自己定义，在etherpad安装与配置中需要用户。</p><h4 id="创建linux用户"><a href="#创建linux用户" class="headerlink" title="创建linux用户"></a>创建linux用户</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adduser --home /opt/etherpad --shell /bin/bash etherpad</span><br><span class="line">install -d -m 755 -o etherpad -g etherpad /opt/etherpad</span><br></pre></td></tr></table></figure><p>用户启动使用etherpad程序，我之前没有建立用户，直接用root去启动，会提示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_16_centos opt]# bash /opt/etherpad-lite/bin/run.sh</span><br><span class="line">You shouldn&apos;t start Etherpad as root!</span><br><span class="line">Please type &apos;Etherpad rocks my socks&apos; or supply the &apos;--root&apos; argument if you still want to start it as root</span><br></pre></td></tr></table></figure></p><p>也可以在启动的命令后面加上–root进行启动，但是既然etherpad不让用root，那就新建一个就好了。</p><div class="post_cus_note">准备工作已经完毕。。。。。。</div><h4 id="下载etherpad"><a href="#下载etherpad" class="headerlink" title="下载etherpad"></a>下载etherpad</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su etherpad</span><br><span class="line">cd ~</span><br><span class="line">git clone https://github.com/ether/etherpad-lite</span><br></pre></td></tr></table></figure><p>切换etherpad用户，如果没有git命令的用户进行安装，文章最后有相关参考。<br>把etherpad放在自己想要放的目录。</p><h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><blockquote><p>创建配置文件</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp ~/etherpad-lite/settings.json.template ~/etherpad-lite/settings.json</span><br></pre></td></tr></table></figure><blockquote><p>编辑配置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/etherpad-lite/settings.json</span><br></pre></td></tr></table></figure><ul><li><p>Ip配置<br>在配置中搜索<strong><em>0.0.0.0</em></strong>，在文件88行，<strong><em>IP</em></strong>改成服务器IP，<strong><em>PORT</em></strong>端口改成自己设置的端口，去掉注释，配置更改如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;ip&quot;: &quot;192.168.151.64&quot;,</span><br><span class="line">&quot;port&quot;: 9002,</span><br></pre></td></tr></table></figure></li><li><p>数据库配置<br>在配置中搜索<strong><em>dbType</em></strong>，在文件144行，这里用的信息都是在数据库安装配置中设置的配置，写清楚即可，去掉注释，配置更改如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;dbType&quot; : &quot;mysql&quot;,</span><br><span class="line">&quot;dbSettings&quot; : &#123;</span><br><span class="line">  &quot;user&quot;:     &quot;etherpad&quot;,</span><br><span class="line">  &quot;host&quot;:     &quot;192.168.151.64&quot;,</span><br><span class="line">  &quot;port&quot;:     3306,</span><br><span class="line">  &quot;password&quot;: &quot;123456&quot;,</span><br><span class="line">  &quot;database&quot;: &quot;etherpad&quot;,</span><br><span class="line">  &quot;charset&quot;:  &quot;utf8mb4&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li><li><p>管理员<br>在配置中搜索<strong><em>password</em></strong>，在文件365行，这里用的信息都是在数据库安装配置中设置的配置，去掉注释，配置更改如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&quot;users&quot;: &#123;</span><br><span class="line">  &quot;admin&quot;: &#123;</span><br><span class="line">    // 1) &quot;password&quot; can be replaced with &quot;hash&quot; if you install ep_hash_auth</span><br><span class="line">    // 2) please note that if password is null, the user will not be created</span><br><span class="line">    &quot;password&quot;: &quot;admin&quot;,</span><br><span class="line">    &quot;is_admin&quot;: true</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;user&quot;: &#123;</span><br><span class="line">    // 1) &quot;password&quot; can be replaced with &quot;hash&quot; if you install ep_hash_auth</span><br><span class="line">    // 2) please note that if password is null, the user will not be created</span><br><span class="line">    &quot;password&quot;: &quot;user&quot;,</span><br><span class="line">    &quot;is_admin&quot;: false</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>保存配置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:wq</span><br><span class="line"></span><br><span class="line">:X</span><br></pre></td></tr></table></figure><p>用哪个都可以，vim保存并退出。</p><h4 id="etherpad安装依赖"><a href="#etherpad安装依赖" class="headerlink" title="etherpad安装依赖"></a>etherpad安装依赖</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash ~/etherpad-lite/bin/installDeps.sh</span><br></pre></td></tr></table></figure><p>安装一下etherpad所需要的依赖包。</p><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/etherpad-lite/bin/run.sh</span><br></pre></td></tr></table></figure><p>用etherpad用户直接执行上面命令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#/opt/etherpad/etherpad-lite/bin/run.sh</span><br><span class="line"></span><br><span class="line">Ensure that all dependencies are up to date...  If this is the first time you have run Etherpad please be patient.</span><br><span class="line">audited 13370 packages in 5.363s</span><br><span class="line"></span><br><span class="line">8 packages are looking for funding</span><br><span class="line">  run `npm fund` for details</span><br><span class="line"></span><br><span class="line">found 5 vulnerabilities (3 low, 2 high)</span><br><span class="line">  run `npm audit fix` to fix them, or `npm audit` for details</span><br><span class="line">Clearing minified cache...</span><br><span class="line">Started Etherpad...</span><br><span class="line">[2019-12-28 15:27:21.215] [DEBUG] console - Running on Node v12.14.0 (minimum required Node version: 8.9.0)</span><br><span class="line">[2019-12-28 15:27:21.324] [INFO] console - All relative paths will be interpreted relative to the identified Etherpad base dir: /opt/etherpad/etherpad-lite</span><br><span class="line">[2019-12-28 15:27:21.324] [DEBUG] AbsolutePaths - Relative path &quot;settings.json&quot; can be rewritten to &quot;/opt/etherpad/etherpad-lite/settings.json&quot;</span><br><span class="line">[2019-12-28 15:27:21.325] [DEBUG] AbsolutePaths - Relative path &quot;credentials.json&quot; can be rewritten to &quot;/opt/etherpad/etherpad-lite/credentials.json&quot;</span><br><span class="line">[2019-12-28 15:27:21.331] [INFO] console - settings loaded from: /opt/etherpad/etherpad-lite/settings.json</span><br><span class="line">[2019-12-28 15:27:21.331] [INFO] console - No credentials file found in /opt/etherpad/etherpad-lite/credentials.json. Ignoring.</span><br><span class="line">[2019-12-28 15:27:21.332] [INFO] console - Using skin &quot;colibris&quot; in dir: /opt/etherpad/etherpad-lite/src/static/skins/colibris</span><br><span class="line">[2019-12-28 15:27:21.332] [INFO] console - Session key loaded from: /opt/etherpad/etherpad-lite/SESSIONKEY.txt</span><br><span class="line">[2019-12-28 15:27:21.381] [ERROR] console - (node:25518) [DEP0126] DeprecationWarning: timers.active() is deprecated. Please use timeout.refresh() instead.</span><br><span class="line">[2019-12-28 15:27:21.382] [ERROR] console - (node:25518) [DEP0096] DeprecationWarning: timers.unenroll() is deprecated. Please use clearTimeout instead.</span><br><span class="line">[2019-12-28 15:27:21.831] [INFO] APIHandler - Api key file read from: &quot;/opt/etherpad/etherpad-lite/APIKEY.txt&quot;</span><br><span class="line">[2019-12-28 15:27:22.139] [INFO] console - Installed plugins: ep_align@0.0.24, ep_image_upload@1.0.12</span><br><span class="line">[2019-12-28 15:27:22.142] [INFO] console - Report bugs at https://github.com/ether/etherpad-lite/issues</span><br><span class="line">[2019-12-28 15:27:22.143] [INFO] console - Your Etherpad version is 1.8.0 (5bcc5a3)</span><br><span class="line">[2019-12-28 15:27:22.228] [INFO] console - You can access your Etherpad instance at http://192.168.151.64:9001/</span><br><span class="line">[2019-12-28 15:27:22.228] [INFO] console - The plugin admin page is at http://192.168.151.64:9001/admin/plugins</span><br><span class="line">[2019-12-28 15:27:22.228] [WARN] console - Etherpad is running in Development mode.  This mode is slower for users and less secure than production mode.  You should set the NODE_ENV environment variable to production by using: export NODE_ENV=production</span><br></pre></td></tr></table></figure></p><h4 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h4><p>在浏览器上直接访问：<a href="http://IP:PORT，服务器IP" target="_blank" rel="noopener">http://IP:PORT，服务器IP</a> + 配置的PORT端口。</p><div class="post_cus_note">列举一下可能遇到的问题</div><h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><blockquote><p>端口设置</p></blockquote><p>如果在浏览器访问，提示服务不可以用，那么检查一下服务器防火墙问题。</p><ul><li><p>检查端口是否开通</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#firewall-cmd --list-all</span><br><span class="line">public (active)</span><br><span class="line">  target: default</span><br><span class="line">  icmp-block-inversion: no</span><br><span class="line">  interfaces: enp3s0</span><br><span class="line">  sources:</span><br><span class="line">  services: dhcpv6-client mysql ssh</span><br><span class="line">  ports: 3306/tcp 8090/tcp 80/tcp 10000/tcp 9001/tcp</span><br><span class="line">  protocols:</span><br><span class="line">  masquerade: no</span><br><span class="line">  forward-ports:</span><br><span class="line">  source-ports:</span><br><span class="line">  icmp-blocks:</span><br><span class="line">  rich rules:</span><br></pre></td></tr></table></figure></li><li><p>开放端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=9001/tcp</span><br></pre></td></tr></table></figure></li><li><p>重启服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart firewalld</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>npm版本</p></blockquote><p>在安装etherpad依赖包或者其他包的时候，有的也许会提示<strong><em>node版本过低</em></strong>，更新下就好，这里推荐用n去更新。</p><p>文章最后有相关参考。</p><blockquote><p>etherpad依赖脚本不可执行</p></blockquote><p>如果遇到<strong><em>/opt/etherpad/etherpad-lite/bin/run.sh</em></strong>脚本不被执行，那么将脚本改变读、写、执行的权限。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /opt/etherpad/etherpad-lite/bin/run.sh</span><br></pre></td></tr></table></figure></p><h3 id="插件配置"><a href="#插件配置" class="headerlink" title="插件配置"></a>插件配置</h3><p>在这里，是主要配置etherpad的插件，有几个还是蛮好用，具体配置在下面有解释，访问Ip:Port/admin，账号密码就是在etherpad配置的那个。</p><p><img src="search_plugin.png" alt></p><h4 id="align"><a href="#align" class="headerlink" title="align"></a>align</h4><p>作用：文字左、中、右对齐插件。</p><blockquote><p>查找</p></blockquote><p>在搜索出查找<strong><em>align</em></strong>。</p><blockquote><p>安装</p></blockquote><p>搜索到之后进行<strong><em>install</em></strong>安装。</p><blockquote><p>配置</p></blockquote><p>打开Settings找到toolbar，去掉toolbar的注视，在414行添加以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[“alignLeft”, “alignCenter”, “alignJustify”, “alignRight”]</span><br></pre></td></tr></table></figure></p><blockquote><p>结果</p></blockquote><p><img src="align.jpg" alt></p><h4 id="image-upload"><a href="#image-upload" class="headerlink" title="image_upload"></a>image_upload</h4><p>作用：图片上传功能。</p><blockquote><p>查找</p></blockquote><p>在搜索出查找<strong><em>image</em></strong>。</p><blockquote><p>安装</p></blockquote><p>搜索到之后进行<strong><em>install</em></strong>安装。</p><blockquote><p>配置</p></blockquote><p>打开Settings找到toolbar，在415行添加以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  &quot;toolbar&quot;: &#123;</span><br><span class="line">    &quot;left&quot;: [</span><br><span class="line">      [&quot;bold&quot;, &quot;italic&quot;, &quot;underline&quot;, &quot;strikethrough&quot;],</span><br><span class="line">      [&quot;orderedlist&quot;, &quot;unorderedlist&quot;, &quot;indent&quot;, &quot;outdent&quot;],</span><br><span class="line">      [&quot;undo&quot;, &quot;redo&quot;],</span><br><span class="line">      [&quot;clearauthorship&quot;],</span><br><span class="line">      [&quot;alignLeft&quot;, &quot;alignCenter&quot;, &quot;alignJustify&quot;, &quot;alignRight&quot;],</span><br><span class="line">      [&quot;addImage&quot;]</span><br><span class="line">    ],</span><br><span class="line">    &quot;right&quot;: [</span><br><span class="line">      [&quot;importexport&quot;, &quot;timeslider&quot;, &quot;savedrevision&quot;],</span><br><span class="line">      [&quot;settings&quot;, &quot;embed&quot;],</span><br><span class="line">      [&quot;showusers&quot;]</span><br><span class="line">    ],</span><br><span class="line">    &quot;timeslider&quot;: [</span><br><span class="line">      [&quot;timeslider_export&quot;, &quot;timeslider_returnToPad&quot;]</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;ep_image_upload&quot;: &#123;</span><br><span class="line">      &quot;fileTypes&quot;: [&quot;jpeg&quot;,&quot;jpg&quot;,&quot;bmp&quot;,&quot;gif&quot;,&quot;png&quot;],</span><br><span class="line">      &quot;maxFileSize&quot;: 5000000</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><blockquote><p>结果</p></blockquote><p><img src="image-upload.png" alt></p><font size="6.5" color="red">插件根据自己的需求制定。。。。。。</font><h3 id="额外脚本"><a href="#额外脚本" class="headerlink" title="额外脚本"></a>额外脚本</h3><p>我把启动与杀死进程做成了.sh脚本，具体如下：</p><blockquote><p>start</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup /opt/etherpad/etherpad-lite/bin/run.sh&gt;/dev/null  2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><blockquote><p>end</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep etherpad | grep -v grep | awk -F &quot; &quot; &apos;&#123;print $2&#125;&apos; | xargs kill</span><br></pre></td></tr></table></figure><blockquote><p>nohub无此命令</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 切换用户</span><br><span class="line">su root</span><br><span class="line"></span><br><span class="line"># 安装</span><br><span class="line">yum install coreutils</span><br><span class="line"></span><br><span class="line"># check</span><br><span class="line">which nohub</span><br></pre></td></tr></table></figure><h3 id="nginx域名配置"><a href="#nginx域名配置" class="headerlink" title="nginx域名配置"></a>nginx域名配置</h3><p>nginx配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_16_centos nginx]# cat /etc/nginx/conf.d/etherpad.conf</span><br><span class="line">server &#123;</span><br><span class="line">    listen  9001;</span><br><span class="line">    server_name     _;</span><br><span class="line"></span><br><span class="line">    access_log  /var/log/nginx/etherpad9001.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">         proxy_pass http://172.17.0.16:9002/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 404 /error.html;</span><br><span class="line">    location = /40x.html &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 500 502 503 504 /error.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>因为本人的域名还在审核中，这里用ip进行访问。<br><div class="note danger">            <p>说明一下：本人的服务器是腾讯云服务器，所以在配置nginx监听的IP是外网IP、端口是9001，在etherpad配置里面配置内网IP以及端口是9002。</p>          </div></p><h3 id="测试地址"><a href="#测试地址" class="headerlink" title="测试地址"></a>测试地址</h3><p><a href="http://212.64.61.62:9001/" target="_blank" rel="noopener">http://212.64.61.62:9001/</a></p><h3 id="学习参考"><a href="#学习参考" class="headerlink" title="学习参考"></a>学习参考</h3><p>官网：<a href="https://etherpad.org/" target="_blank" rel="noopener">https://etherpad.org/</a><br>Github：<a href="https://github.com/ether/etherpad-lite" target="_blank" rel="noopener">https://github.com/ether/etherpad-lite</a><br>MariaDB安装：<a href="https://www.jianshu.com/p/85ad52c88399" target="_blank" rel="noopener">https://www.jianshu.com/p/85ad52c88399</a><br>Git安装：<a href="https://www.jianshu.com/p/f19d1473c3e1" target="_blank" rel="noopener">https://www.jianshu.com/p/f19d1473c3e1</a><br>node与npm更新：<a href="https://www.jianshu.com/p/2ad99f605499" target="_blank" rel="noopener">https://www.jianshu.com/p/2ad99f605499</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/article_etherpad.jpg&quot; alt&gt;&lt;/p&gt;
&lt;h3 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h3&gt;&lt;div class=&quot;note primary&quot;&gt;
            &lt;p&gt;官网：Etherpad is a highly customizable Open Source online editor providing collaborative editing in really real-time.&lt;/p&gt;&lt;p&gt;个人翻译：Etherpad是一款定制、开源的在线编辑器，提供实时协作编辑。&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="工具集" scheme="http://pygo2.cn/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    
    
      <category term="运维工具" scheme="http://pygo2.cn/tags/%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7/"/>
    
      <category term="etherpad" scheme="http://pygo2.cn/tags/etherpad/"/>
    
  </entry>
  
  <entry>
    <title>圣诞节【&lt;font color=&quot;#00BB00&quot; size=&quot;5&quot;&gt;西方节&lt;/font&gt;】</title>
    <link href="http://pygo2.cn/articles/30667/"/>
    <id>http://pygo2.cn/articles/30667/</id>
    <published>2019-12-24T06:43:18.000Z</published>
    <updated>2019-12-25T06:43:18.000Z</updated>
    
    <content type="html"><![CDATA[<div class="post_cus_note">西方节-圣诞节</div><p><img src="/images/article_jieri_shengdanjie.jpg" alt></p><font size="6.5" color="red">持续更新中。。。。。。</font><a id="more"></a><hr><table><thead><tr><th style="text-align:center">时间</th><th style="text-align:center">地点</th></tr></thead><tbody><tr><td style="text-align:center">2019-12-25</td><td style="text-align:center">满洲里</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;post_cus_note&quot;&gt;西方节-圣诞节&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/article_jieri_shengdanjie.jpg&quot; alt&gt;&lt;/p&gt;
&lt;font size=&quot;6.5&quot; color=&quot;red&quot;&gt;持续更新中。。。。。。&lt;/font&gt;
    
    </summary>
    
      <category term="节日" scheme="http://pygo2.cn/categories/%E8%8A%82%E6%97%A5/"/>
    
    
      <category term="节日" scheme="http://pygo2.cn/tags/%E8%8A%82%E6%97%A5/"/>
    
      <category term="西方节" scheme="http://pygo2.cn/tags/%E8%A5%BF%E6%96%B9%E8%8A%82/"/>
    
  </entry>
  
  <entry>
    <title>Linux学习之番外篇-w、who、whoami</title>
    <link href="http://pygo2.cn/articles/52265/"/>
    <id>http://pygo2.cn/articles/52265/</id>
    <published>2019-12-24T00:54:11.000Z</published>
    <updated>2019-12-24T00:54:11.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/article_w.jpg" alt></p><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><div class="note danger">            <p>简单总结一下<font color="#dd0000" size="5">w、who、whoami</font>，用于显示当前登录Linux的用户信息，在本篇结束的时候又额外赠送了2个命令，关于学习<font size="6.5" color="red">多多益善。。。。。。</font>。</p>          </div><a id="more"></a><hr><p>在Linux系统中，多账户进行ssh登录是常有的事，但是有时候会去查看一下登录的用户都有谁以及相关的登录信息。</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">w</td><td style="text-align:center">显示当前登录的用户及信息</td></tr><tr><td style="text-align:center">who</td><td style="text-align:center">显示当前已经登录的用户名、终端名称、登录时间及登录IP</td></tr><tr><td style="text-align:center">whoami</td><td style="text-align:center">显示当前用户的用户名</td></tr><tr><td style="text-align:center">id</td><td style="text-align:center">用于check系统是有此用户</td></tr><tr><td style="text-align:center">last</td><td style="text-align:center">显示近期用户或终端的登录情况</td></tr></tbody></table><h4 id="w"><a href="#w" class="headerlink" title="w"></a>w</h4><p>显示当前登录的用户及信息，除了这些还会显示当前登录了几个用户、系统当前的load。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@bash ~]# w</span><br><span class="line"> 20:22:25 up 15:55,  3 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     tty1                      Tue21   15:27m  0.09s  0.09s -bash</span><br><span class="line">root     pts/0    192.168.1.116    19:23    1.00s  0.12s  0.01s w</span><br><span class="line">root     tty2                      07:43   19:29   0.02s  0.02s -bash</span><br></pre></td></tr></table></figure><h4 id="who"><a href="#who" class="headerlink" title="who"></a>who</h4><p>显示当前已经登录的用户名、终端名称、登录时间及登录IP。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@bash ~]# who</span><br><span class="line">root     tty1         2019-12-24 21:23</span><br><span class="line">root     pts/0        2019-12-24 19:23 (192.168.1.116)</span><br><span class="line">root     tty2         2019-12-24 07:43</span><br></pre></td></tr></table></figure><h4 id="whoami"><a href="#whoami" class="headerlink" title="whoami"></a>whoami</h4><p>显示当前用户的用户名。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@bash ~]# whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure></p><div class="post_cus_note">额外赠送</div><h4 id="id"><a href="#id" class="headerlink" title="id"></a>id</h4><p>用于显示用户的ID，以及所属群组的ID，主要用于check系统是有此用户。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@bash ~]# id root</span><br><span class="line">uid=0(root) gid=0(wheel) groups=0(wheel)</span><br></pre></td></tr></table></figure></p><h4 id="last"><a href="#last" class="headerlink" title="last"></a>last</h4><p>显示近期用户或终端的登录情况。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@bash ~]# last -n 5</span><br><span class="line">root     pts/0        :0.0             Wed Apr 25 10:12   still logged in</span><br><span class="line">root     pts/1        :0.0             Wed Apr 25 10:06 - 10:10  (00:03)</span><br><span class="line">root     pts/0        :0.0             Wed Apr 25 10:06 - 10:10  (00:03)</span><br><span class="line">root     pts/0        :0.0             Wed Apr 25 10:02 - 10:06  (00:04)</span><br><span class="line">root     pts/0        :0.0             Wed Apr 25 09:51 - 09:51  (00:00)</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/article_w.jpg&quot; alt&gt;&lt;/p&gt;
&lt;h4 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h4&gt;&lt;div class=&quot;note danger&quot;&gt;
            &lt;p&gt;简单总结一下&lt;font color=&quot;#dd0000&quot; size=&quot;5&quot;&gt;w、who、whoami&lt;/font&gt;，用于显示当前登录Linux的用户信息，在本篇结束的时候又额外赠送了2个命令，关于学习&lt;font size=&quot;6.5&quot; color=&quot;red&quot;&gt;多多益善。。。。。。&lt;/font&gt;。&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://pygo2.cn/categories/Linux/"/>
    
    
      <category term="Linux" scheme="http://pygo2.cn/tags/Linux/"/>
    
      <category term="Linux番外篇" scheme="http://pygo2.cn/tags/Linux%E7%95%AA%E5%A4%96%E7%AF%87/"/>
    
  </entry>
  
  <entry>
    <title>Hexo-环境搭建之node版本问题</title>
    <link href="http://pygo2.cn/articles/10512/"/>
    <id>http://pygo2.cn/articles/10512/</id>
    <published>2019-12-17T02:55:42.000Z</published>
    <updated>2019-12-17T02:55:42.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><div class="note success">            <p>昨天买了个腾讯云服务器 + 域名，于是把自己的blog迁移云服务上，就得搭建nodejs、npm、hexo等运行环境。但是环境都装好了，一运行<strong><em>hexo</em></strong>居然报错了，错的内容在正文。</p><p>既然出现错误，解决就好了。</p>          </div><a id="more"></a><hr><h4 id="错误内容"><a href="#错误内容" class="headerlink" title="错误内容"></a>错误内容</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">usr/lib/node_modules/hexo-cli/node_modules/chokidar/index.js:150</span><br><span class="line">async remove(item) &#123;</span><br><span class="line">^^^^^^</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SyntaxError: Unexpected identifier</span><br><span class="line">at createScript (vm.js:56:10)</span><br><span class="line">at Object.runInThisContext (vm.js:97:10)</span><br><span class="line">at Module._compile (module.js:549:28)</span><br><span class="line">at Object.Module._extensions..js (module.js:586:10)</span><br><span class="line">at Module.load (module.js:494:32)</span><br><span class="line">at tryModuleLoad (module.js:453:12)</span><br><span class="line">at Function.Module._load (module.js:445:3)</span><br><span class="line">at Module.require (module.js:504:17)</span><br><span class="line">at require (internal/module.js:20:19)</span><br><span class="line">at Object.&lt;anonymous&gt; (/usr/lib/node_modules/hexo-cli/node_modules/hexo-fs/lib/fs.js:6:18)</span><br><span class="line">at Module._compile (module.js:577:32)</span><br><span class="line">at Object.Module._extensions..js (module.js:586:10)</span><br><span class="line">at Module.load (module.js:494:32)</span><br><span class="line">at tryModuleLoad (module.js:453:12)</span><br><span class="line">at Function.Module._load (module.js:445:3)</span><br><span class="line">at Module.require (module.js:504:17)</span><br></pre></td></tr></table></figure><p>上述的错误搜索了好半天才没有到找到一个解决办法，不过在失去希望的时候，发了在baidu论坛有个人跟我报了一样的错误，而且还解决了，不买官司了，原因是：<font size="6.5" color="red">node版本过低</font>。</p><h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><p>升级nodejs即可，具体操作如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">npm install -g n</span><br><span class="line"></span><br><span class="line"># 升级到最新稳定版本：</span><br><span class="line">n stable</span><br><span class="line"></span><br><span class="line"># 升级到最新版本：</span><br><span class="line">n latest</span><br><span class="line"></span><br><span class="line"># 升级到指定版本：</span><br><span class="line">n 0.10.26</span><br></pre></td></tr></table></figure><h4 id="学习参考"><a href="#学习参考" class="headerlink" title="学习参考"></a>学习参考</h4><p>n：<a href="https://www.jianshu.com/p/a2ee8f61a8ca" target="_blank" rel="noopener">https://www.jianshu.com/p/a2ee8f61a8ca</a><br>帖子：<a href="https://tieba.baidu.com/p/6311927039?red_tag=1232994946" target="_blank" rel="noopener">https://tieba.baidu.com/p/6311927039?red_tag=1232994946</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h4&gt;&lt;div class=&quot;note success&quot;&gt;
            &lt;p&gt;昨天买了个腾讯云服务器 + 域名，于是把自己的blog迁移云服务上，就得搭建nodejs、npm、hexo等运行环境。但是环境都装好了，一运行&lt;strong&gt;&lt;em&gt;hexo&lt;/em&gt;&lt;/strong&gt;居然报错了，错的内容在正文。&lt;/p&gt;&lt;p&gt;既然出现错误，解决就好了。&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="Hexo" scheme="http://pygo2.cn/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="http://pygo2.cn/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>ffmpeg的基础学习</title>
    <link href="http://pygo2.cn/articles/37692/"/>
    <id>http://pygo2.cn/articles/37692/</id>
    <published>2019-12-15T07:19:18.000Z</published>
    <updated>2019-12-17T07:19:18.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><div class="note primary">            <p><img src="/images/article_ffmpeg.png" alt></p><p>大致的意思：FFmpeg是一款多媒体框架，能处理音频、视频等，不管什么格式的数据都可以进行处理，支持MacOS、Windows、Linux等各种系统。</p><p>FFmpeg：<font size="6" color="red">我是处理媒介数据方面的专家，我很牛逼，快来用我吧！！！</font><br>我：<font size="6" color="blue">好的，👌！</font></p>          </div><a id="more"></a><hr><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>因为公司做了一个宣传片，把宣传片视频上传到第三方网站上，发现非会员会有广告。这还得了，如果客户没有会员，岂不是要等，为了解决这个问题，从一个程序员的角度来想办法，直接做个页面，把视频放进去，通过域名访问就可以解决无广告的问题。</p><p>周末花了一上午的时候搞完了，通过域名直接访问看，可以播放视频，但是发现视频有点卡，查看了一下视频大小：6分钟的视频500M，有点大啊，于是想压缩一下，上网搜索<strong><em>在线 视频压缩</em></strong>，TMD，要不就收费、要不就限制100M，身为程序员的我咋可能花钱去处理。于是，继续搜索<strong><em>python 视频压缩</em></strong>，看到了自己没有见过的<strong><em>ffmpeg</em></strong>命令，查了下资料，评价还不错，花了1小时搞定了<strong><em>ffmpeg</em></strong>环境，压缩 + 转格式的方式处理，最后视频110M，压缩了将近4/5，为了方便日后使用以及推荐给大家使用，写下本篇。</p><p>背景介绍完毕了，开始搞。</p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>安装需要下载2个文件：ffmpeg音视频处理工具，yasm是一款汇编器。yasm是安不安装都可以，既然ffmpeg里面都要求了就装上，省得日后麻烦。<br>文件下载地址：<br>yasm：<a href="http://yasm.tortall.net/Download.html" target="_blank" rel="noopener">http://yasm.tortall.net/Download.html</a><br>ffmpeg：<a href="http://ffmpeg.org/download.html" target="_blank" rel="noopener">http://ffmpeg.org/download.html</a></p><p>都是国外下载地址，如果翻不过去，本篇提供下载地址，百度云盘：</p><table><thead><tr><th style="text-align:center">name</th><th style="text-align:center">url</th><th style="text-align:center">password</th></tr></thead><tbody><tr><td style="text-align:center">yasm</td><td style="text-align:center"><a href="https://pan.baidu.com/s/14CEpqZvDhgyIcwjsINw4Gg" target="_blank" rel="noopener">https://pan.baidu.com/s/14CEpqZvDhgyIcwjsINw4Gg</a></td><td style="text-align:center">ymw5</td></tr><tr><td style="text-align:center">ffmpeg</td><td style="text-align:center"><a href="https://pan.baidu.com/s/1n65Ss2S7rtp5bYIFxKHeHQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1n65Ss2S7rtp5bYIFxKHeHQ</a></td><td style="text-align:center">j3oj</td></tr></tbody></table><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="上传-amp-amp-解压"><a href="#上传-amp-amp-解压" class="headerlink" title="上传 &amp;&amp; 解压"></a>上传 &amp;&amp; 解压</h4><p>把yasm &amp;&amp; ffmpeg文件下载到本地，需要上传到Linux服务器，在这里我采用的<strong><em>scp</em></strong>命令。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp ~/Downloads/ffmpeg/* root@192.168.151.64:~</span><br></pre></td></tr></table></figure><p>上传完之后，ssh连接服务器，找到上传的文件进行解压：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ffmpeg</span><br><span class="line">tar -jxvf ffmpeg-4.2.1.tar.bz2</span><br><span class="line"></span><br><span class="line"># yasm</span><br><span class="line">tar -zxvf yasm-1.3.0.tar.gz</span><br></pre></td></tr></table></figure><p>看好了，在这里yasm用的参数是<strong>z</strong>，ffmpeg用的是<strong>j</strong>，因为压缩的格式不一样，所以参数是不一样的，不知道的请看下tar的用法。</p><h4 id="yasm安装"><a href="#yasm安装" class="headerlink" title="yasm安装"></a>yasm安装</h4><p>进入到yasm-1.3.0进行编译安装，因为是源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd yasm-1.3.0/</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>这个安装过程是没有任何问题的，等待安装完成即可。</p><h4 id="ffmpeg安装"><a href="#ffmpeg安装" class="headerlink" title="ffmpeg安装"></a>ffmpeg安装</h4><p>进入ffmpeg-4.2.1文件夹进行编译安装。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure --enable-shared --prefix=/usr/loacl/ffmpeg</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>编译过程有点长，请耐心等待，也可以做些别的事情。<br>安装成功后，<strong><em>cd /usr/loacl/ffmpeg</em></strong>进入安装目录，查看一下发现有bin、include,、ib、share这4个目录，</p><ul><li>bin：是ffmpeg主程序二进制目录</li><li>include是C/C++头文件目录</li><li>lib是编译好的库文件目录</li><li>share是文档目录</li></ul><h4 id="lib配置"><a href="#lib配置" class="headerlink" title="lib配置"></a>lib配置</h4><blockquote><p>ld.so.conf</p></blockquote><p>编辑lib包的配置文件，加入<strong><em>/usr/local/ffmpeg/lib</em></strong>内容（/usr/local/ffmpeg是ffmpeg的安装目录，根据个人不同安装目录修改）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ld.so.conf</span><br></pre></td></tr></table></figure></p><p>更新环境变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldconfig</span><br></pre></td></tr></table></figure></p><blockquote><p>/etc/profile</p></blockquote><p>打开/etc/profile文件，在文件末尾加入以下内容:<br>export PATH=”/usr/local/ffmpeg/bin:$PATH”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure></p><p>然后保存并运行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></p><h4 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h4><p>如果上步配置正确了，那么运行ffmpeg命令就会出现下图所示，因为ffmpeg不是系统命令，也不再系统PATH里面，所以执行要写全路径+ffmpeg。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /usr/local/ffmpeg/bin]#./ffmpeg</span><br><span class="line">ffmpeg version 4.2.1 Copyright (c) 2000-2019 the FFmpeg developers</span><br><span class="line">  built with gcc 4.8.5 (GCC) 20150623 (Red Hat 4.8.5-39)</span><br><span class="line">  configuration: --enable-shared --prefix=/usr/local/ffmpeg</span><br><span class="line">  libavutil      56. 31.100 / 56. 31.100</span><br><span class="line">  libavcodec     58. 54.100 / 58. 54.100</span><br><span class="line">  libavformat    58. 29.100 / 58. 29.100</span><br><span class="line">  libavdevice    58.  8.100 / 58.  8.100</span><br><span class="line">  libavfilter     7. 57.100 /  7. 57.100</span><br><span class="line">  libswscale      5.  5.100 /  5.  5.100</span><br><span class="line">  libswresample   3.  5.100 /  3.  5.100</span><br><span class="line">Hyper fast Audio and Video encoder</span><br><span class="line">usage: ffmpeg [options] [[infile options] -i infile]... &#123;[outfile options] outfile&#125;...</span><br><span class="line"></span><br><span class="line">Use -h to get full help or, even better, run &apos;man ffmpeg&apos;</span><br></pre></td></tr></table></figure><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libavdevice.so.57: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure><p>如果出现了以上问题，那么就检查一下在lib配置配置那步，是否做对了；如果解决不了，欢迎留言咨询。</p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>总结一下本人暂时学到的一些基础使用方法，这个命令很强大，喜欢的可以去官网进行查看详细的使用方法。</p><h4 id="信息获取"><a href="#信息获取" class="headerlink" title="信息获取"></a>信息获取</h4><blockquote><p>获取媒体信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/ffmpeg/bin/ffmpeg -i file_name</span><br></pre></td></tr></table></figure></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#/usr/local/ffmpeg/bin/ffmpeg -i elt.mp4</span><br><span class="line">ffmpeg version 4.2.1 Copyright (c) 2000-2019 the FFmpeg developers</span><br><span class="line">  built with gcc 4.8.5 (GCC) 20150623 (Red Hat 4.8.5-39)</span><br><span class="line">  configuration: --enable-shared --prefix=/usr/local/ffmpeg</span><br><span class="line">  libavutil      56. 31.100 / 56. 31.100</span><br><span class="line">  libavcodec     58. 54.100 / 58. 54.100</span><br><span class="line">  libavformat    58. 29.100 / 58. 29.100</span><br><span class="line">  libavdevice    58.  8.100 / 58.  8.100</span><br><span class="line">  libavfilter     7. 57.100 /  7. 57.100</span><br><span class="line">  libswscale      5.  5.100 /  5.  5.100</span><br><span class="line">  libswresample   3.  5.100 /  3.  5.100</span><br><span class="line">Input #0, mov,mp4,m4a,3gp,3g2,mj2, from &apos;elt.mp4&apos;:</span><br><span class="line">  Metadata:</span><br><span class="line">    major_brand     : mp42</span><br><span class="line">    minor_version   : 0</span><br><span class="line">    compatible_brands: mp42mp41</span><br><span class="line">    creation_time   : 2019-12-12T07:49:20.000000Z</span><br><span class="line">  Duration: 00:06:22.93, start: 0.000000, bitrate: 10291 kb/s</span><br><span class="line">    Stream #0:0(eng): Video: h264 (Main) (avc1 / 0x31637661), yuv420p, 1920x1080 [SAR 1:1 DAR 16:9], 9966 kb/s, 25 fps, 25 tbr, 25k tbn, 50 tbc (default)</span><br><span class="line">    Metadata:</span><br><span class="line">      creation_time   : 2019-12-12T07:49:20.000000Z</span><br><span class="line">      handler_name    : ?Mainconcept Video Media Handler</span><br><span class="line">      encoder         : AVC Coding</span><br><span class="line">    Stream #0:1(eng): Audio: aac (LC) (mp4a / 0x6134706D), 48000 Hz, stereo, fltp, 317 kb/s (default)</span><br><span class="line">    Metadata:</span><br><span class="line">      creation_time   : 2019-12-12T07:49:20.000000Z</span><br><span class="line">      handler_name    : #Mainconcept MP4 Sound Media Handler</span><br><span class="line">At least one output file must be specified</span><br></pre></td></tr></table></figure><p>音频、视频都可以，读取文件的相关信息。</p><blockquote><p>查看支持格式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/ffmpeg/bin/ffmpeg -formats</span><br></pre></td></tr></table></figure></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#/usr/local/ffmpeg/bin/ffmpeg -formats | head -n 10</span><br><span class="line">ffmpeg version 4.2.1 Copyright (c) 2000-2019 the FFmpeg developers</span><br><span class="line">  built with gcc 4.8.5 (GCC) 20150623 (Red Hat 4.8.5-39)</span><br><span class="line">  configuration: --enable-shared --prefix=/usr/local/ffmpeg</span><br><span class="line">  libavutil      56. 31.100 / 56. 31.100</span><br><span class="line">  libavcodec     58. 54.100 / 58. 54.100</span><br><span class="line">  libavformat    58. 29.100 / 58. 29.100</span><br><span class="line">  libavdevice    58.  8.100 / 58.  8.100</span><br><span class="line">  libavfilter     7. 57.100 /  7. 57.100</span><br><span class="line">  libswscale      5.  5.100 /  5.  5.100</span><br><span class="line">  libswresample   3.  5.100 /  3.  5.100</span><br><span class="line">File formats:</span><br><span class="line"> D. = Demuxing supported</span><br><span class="line"> .E = Muxing supported</span><br><span class="line"> --</span><br><span class="line"> D  3dostr          3DO STR</span><br><span class="line">  E 3g2             3GP2 (3GPP2 file format)</span><br><span class="line">  E 3gp             3GP (3GPP file format)</span><br><span class="line"> D  4xm             4X Technologies</span><br><span class="line">  E a64             a64 - video for Commodore 64</span><br><span class="line"> D  aa              Audible AA format files</span><br></pre></td></tr></table></figure><p>查看支持的音频、视频格式。</p><h4 id="格式转换"><a href="#格式转换" class="headerlink" title="格式转换"></a>格式转换</h4><blockquote><p>基础使用</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/ffmpeg/bin/ffmpeg -i elt.mp4 elt_output.avi</span><br><span class="line"></span><br><span class="line"># 多格式输出</span><br><span class="line">/usr/local/ffmpeg/bin/ffmpeg -i elt.mp4 elt_output.avi elt_output.wmv</span><br></pre></td></tr></table></figure><p><img src="ffmpeg_i_tf.png" alt></p><p>命令行中指定文件的输入和输出文件名就行了，这个方法同样适用于视频和音频文件，这个是常用的命令之一。</p><blockquote><p>保留视频质量</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/ffmpeg/bin/ffmpeg -i elt.mp4 -qscale 0 elt_output.avi</span><br></pre></td></tr></table></figure><p>通过-qscale 0参数来保留视频格式转换的视频质量。</p><h4 id="视频压缩"><a href="#视频压缩" class="headerlink" title="视频压缩"></a>视频压缩</h4><blockquote><p>降低比特率</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i elt.mp4 -b:v 1000k -bufsize 1000k elt.mp4</span><br></pre></td></tr></table></figure><p>通过降低比特率(使用 -b:a 或 -ab)来进行视频压缩，一些常用的比特率有: 96k, 112k, 128k, 160k, 192k, 256k, 320k.值越大，文件所需要的体积就越大。</p><h3 id="学习参考"><a href="#学习参考" class="headerlink" title="学习参考"></a>学习参考</h3><p>ffmpeg官网：<a href="http://ffmpeg.org/ffmpeg.html#Audio-Options" target="_blank" rel="noopener">http://ffmpeg.org/ffmpeg.html#Audio-Options</a><br>Linux上的ffmpeg完全使用指南：<a href="https://eyehere.net/2019/the-complete-guide-for-using-ffmpeg-in-linux/#basic-usage" target="_blank" rel="noopener">https://eyehere.net/2019/the-complete-guide-for-using-ffmpeg-in-linux/#basic-usage</a></p><h3 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h3><p>ffmpeg的安装与基础使用先记录到这里吧，但是关于ffmpeg的探索不会停止，学习永无止境，日后有使用到其他命令会更新此博客。</p><font size="6" color="red">不会的东西，干它就完了！！！</font>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h3&gt;&lt;div class=&quot;note primary&quot;&gt;
            &lt;p&gt;&lt;img src=&quot;/images/article_ffmpeg.png&quot; alt&gt;&lt;/p&gt;&lt;p&gt;大致的意思：FFmpeg是一款多媒体框架，能处理音频、视频等，不管什么格式的数据都可以进行处理，支持MacOS、Windows、Linux等各种系统。&lt;/p&gt;&lt;p&gt;FFmpeg：&lt;font size=&quot;6&quot; color=&quot;red&quot;&gt;我是处理媒介数据方面的专家，我很牛逼，快来用我吧！！！&lt;/font&gt;&lt;br&gt;我：&lt;font size=&quot;6&quot; color=&quot;blue&quot;&gt;好的，👌！&lt;/font&gt;&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="工具集" scheme="http://pygo2.cn/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    
    
      <category term="运维工具" scheme="http://pygo2.cn/tags/%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7/"/>
    
      <category term="ffmpeg" scheme="http://pygo2.cn/tags/ffmpeg/"/>
    
  </entry>
  
  <entry>
    <title>Confluence之隐藏人员菜单栏</title>
    <link href="http://pygo2.cn/articles/13168/"/>
    <id>http://pygo2.cn/articles/13168/</id>
    <published>2019-12-10T06:15:33.000Z</published>
    <updated>2019-12-10T06:15:33.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="问题背景"><a href="#问题背景" class="headerlink" title="问题背景"></a>问题背景</h4><div class="note primary">            <p>在公司搭建了一个Wiki，用的是Confluence + MariaDB + Linux架构，搭建之后不管在任何用户的菜单栏都会有用户这个选项，导致不管任何用户都可以邀请、注册等操作，正常来说用户管理只有管理员才有的权限，解决前如下图：</p><p><img src="/images/article_confluence_qian.png" alt></p><font color="red" size="6.0">解决后如下图：</font><p><img src="/images/article_confluence_hou.png" alt></p>          </div><a id="more"></a><hr><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>在网上查了很多，都没有实际的解决方案。于是，官网走起，在官网的<font color="red" size="6.0">Search</font>下，搜索关键字：<font color="red" size="6.0">hide tools menu users</font>，结果如下：</p><p><img src="confluence_search.png" alt></p><p>点进去查看之后，发现给了我一个解决的灵感，具体如下：</p><blockquote><p>登录管理员账户</p></blockquote><blockquote><p>打开设置 -&gt; 一般配置</p></blockquote><p><img src="confluence_config.png" alt></p><blockquote><p>找到自定义HTML</p></blockquote><p><img src="confluence_html.png" alt></p><blockquote><p>在HEAD尾部加入一下代码</p></blockquote><p><img src="confluence_set.png" alt></p><blockquote><p>保存后进行刷新测试</p></blockquote><h4 id="具体代码"><a href="#具体代码" class="headerlink" title="具体代码"></a>具体代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">jQuery().ready(function() &#123;</span><br><span class="line">  jQuery(&quot;#people-directory-link&quot;).hide();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="官方说明"><a href="#官方说明" class="headerlink" title="官方说明"></a>官方说明</h4><p>Confluence官方：<a href="https://confluence.atlassian.com/confkb/how-to-hide-the-space-tools-menu-for-certain-users-or-groups-in-confluence-816877024.html" target="_blank" rel="noopener">https://confluence.atlassian.com/confkb/how-to-hide-the-space-tools-menu-for-certain-users-or-groups-in-confluence-816877024.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;问题背景&quot;&gt;&lt;a href=&quot;#问题背景&quot; class=&quot;headerlink&quot; title=&quot;问题背景&quot;&gt;&lt;/a&gt;问题背景&lt;/h4&gt;&lt;div class=&quot;note primary&quot;&gt;
            &lt;p&gt;在公司搭建了一个Wiki，用的是Confluence + MariaDB + Linux架构，搭建之后不管在任何用户的菜单栏都会有用户这个选项，导致不管任何用户都可以邀请、注册等操作，正常来说用户管理只有管理员才有的权限，解决前如下图：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/images/article_confluence_qian.png&quot; alt&gt;&lt;/p&gt;&lt;font color=&quot;red&quot; size=&quot;6.0&quot;&gt;解决后如下图：&lt;/font&gt;&lt;p&gt;&lt;img src=&quot;/images/article_confluence_hou.png&quot; alt&gt;&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="工具集" scheme="http://pygo2.cn/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    
    
      <category term="WIKI" scheme="http://pygo2.cn/tags/WIKI/"/>
    
      <category term="运维工具" scheme="http://pygo2.cn/tags/%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
</feed>
